<!doctype html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
html {
  font-family: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
.markmap-dark {
  background: #27272a;
  color: white;
}
</style>
<link rel="stylesheet" href="https://unpkg.com/markmap-toolbar@0.18.12/dist/style.css"><link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://unpkg.com/d3@7.9.0/dist/d3.min.js"></script><script src="https://unpkg.com/markmap-view@0.18.12/dist/browser/index.js"></script><script src="https://unpkg.com/markmap-toolbar@0.18.12/dist/index.js"></script><script>((r) => {
          setTimeout(r);
        })(() => {
  const { markmap, mm } = window;
  const toolbar = new markmap.Toolbar();
  toolbar.attach(mm);
  const el = toolbar.render();
  el.setAttribute("style", "position:absolute;bottom:20px;right:20px");
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
              if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
                document.documentElement.classList.add("markmap-dark");
              }
            })(() => window.markmap,null,{"content":"Python &#x8bbe;&#x8ba1;&#x6a21;&#x5f0f;","children":[{"content":"<strong>&#x8bbe;&#x8ba1;&#x6a21;&#x5f0f;&#x5206;&#x7c7b;</strong>","children":[{"content":"1. <strong>&#x521b;&#x5efa;&#x578b;&#x6a21;&#x5f0f;&#xff08;Creational&#xff09;</strong>&#xff1a;&#x5173;&#x6ce8;&#x5bf9;&#x8c61;&#x7684;&#x521b;&#x5efa;&#x673a;&#x5236;","children":[],"payload":{"tag":"li","lines":"10,11","listIndex":1}},{"content":"2. <strong>&#x7ed3;&#x6784;&#x578b;&#x6a21;&#x5f0f;&#xff08;Structural&#xff09;</strong>&#xff1a;&#x5173;&#x6ce8;&#x7c7b;&#x548c;&#x5bf9;&#x8c61;&#x7684;&#x7ec4;&#x5408;","children":[],"payload":{"tag":"li","lines":"11,12","listIndex":2}},{"content":"3. <strong>&#x884c;&#x4e3a;&#x578b;&#x6a21;&#x5f0f;&#xff08;Behavioral&#xff09;</strong>&#xff1a;&#x5173;&#x6ce8;&#x5bf9;&#x8c61;&#x4e4b;&#x95f4;&#x7684;&#x901a;&#x4fe1;&#x548c;&#x804c;&#x8d23;&#x5206;&#x914d;","children":[],"payload":{"tag":"li","lines":"12,14","listIndex":3}}],"payload":{"tag":"h2","lines":"6,7"}},{"content":"<strong>1. &#x521b;&#x5efa;&#x578b;&#x6a21;&#x5f0f;</strong>","children":[{"content":"<svg width=\"16\" height=\"16\" viewBox=\"0 -3 24 24\"><path d=\"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z\"/></svg> <strong>&#x5de5;&#x5382;&#x6a21;&#x5f0f;&#xff08;Factory Pattern&#xff09;</strong>","children":[{"content":"<pre data-lines=\"44,75\"><code class=\"language-python\"><span class=\"hljs-keyword\">from</span> typing <span class=\"hljs-keyword\">import</span> <span class=\"hljs-type\">Literal</span>, Protocol\n\n<span class=\"hljs-comment\"># 1. &#x5b9a;&#x4e49;&#x534f;&#x8bae;&#xff08;&#x7edf;&#x4e00;&#x63a5;&#x53e3;&#xff09;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TaskQueue</span>(<span class=\"hljs-title class_ inherited__\">Protocol</span>):\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">add_task</span>(<span class=\"hljs-params\">self, task: Task</span>) -&gt; <span class=\"hljs-literal\">None</span>: ...\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_pending_tasks</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">list</span>[Task]: ...\n\n<span class=\"hljs-comment\"># 2. &#x7c7b;&#x578b;&#x522b;&#x540d;&#xff1a;&#x9650;&#x5236;&#x961f;&#x5217;&#x7c7b;&#x578b;</span>\nQueueType = <span class=\"hljs-type\">Literal</span>[<span class=\"hljs-string\">&quot;sqlite&quot;</span>, <span class=\"hljs-string\">&quot;redis&quot;</span>, <span class=\"hljs-string\">&quot;memory&quot;</span>]\n\n<span class=\"hljs-comment\"># 3. &#x5de5;&#x5382;&#x7c7b;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">QueueFactory</span>:\n<span class=\"hljs-meta\">    @staticmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">create</span>(<span class=\"hljs-params\">queue_type: QueueType, **kwargs</span>) -&gt; TaskQueue:\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x6839;&#x636e;&#x7c7b;&#x578b;&#x521b;&#x5efa;&#x961f;&#x5217;&quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">if</span> queue_type == <span class=\"hljs-string\">&quot;sqlite&quot;</span>:\n            <span class=\"hljs-keyword\">return</span> SQLiteTaskQueue(**kwargs)\n        <span class=\"hljs-keyword\">elif</span> queue_type == <span class=\"hljs-string\">&quot;redis&quot;</span>:\n            <span class=\"hljs-keyword\">return</span> RedisTaskQueue(**kwargs)\n        <span class=\"hljs-keyword\">elif</span> queue_type == <span class=\"hljs-string\">&quot;memory&quot;</span>:\n            <span class=\"hljs-keyword\">return</span> InMemoryTaskQueue()\n        <span class=\"hljs-keyword\">else</span>:\n            <span class=\"hljs-keyword\">raise</span> ValueError(<span class=\"hljs-string\">f&quot;Unsupported: <span class=\"hljs-subst\">{queue_type}</span>&quot;</span>)\n\n<span class=\"hljs-comment\"># 4. &#x4f7f;&#x7528;</span>\n<span class=\"hljs-comment\"># &#x5f00;&#x53d1;&#x73af;&#x5883;</span>\ndev_queue = QueueFactory.create(<span class=\"hljs-string\">&quot;memory&quot;</span>)\n<span class=\"hljs-comment\"># &#x751f;&#x4ea7;&#x73af;&#x5883;</span>\nprod_queue = QueueFactory.create(<span class=\"hljs-string\">&quot;sqlite&quot;</span>, db_path=<span class=\"hljs-string\">&quot;prod.db&quot;</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"44,75"}}],"payload":{"tag":"h3","lines":"18,19"}},{"content":"<svg width=\"16\" height=\"16\" viewBox=\"0 -3 24 24\"><path d=\"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z\"/></svg> <strong>&#x5355;&#x4f8b;&#x6a21;&#x5f0f;&#xff08;Singleton Pattern&#xff09;</strong>","children":[{"content":"<pre data-lines=\"104,140\"><code class=\"language-python\"><span class=\"hljs-comment\"># &#x65b9;&#x5f0f; 1&#xff1a;&#x91cd;&#x5199; __new__</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DatabaseConnection</span>:\n    _instance = <span class=\"hljs-literal\">None</span>\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__new__</span>(<span class=\"hljs-params\">cls</span>):\n        <span class=\"hljs-keyword\">if</span> cls._instance <span class=\"hljs-keyword\">is</span> <span class=\"hljs-literal\">None</span>:\n            cls._instance = <span class=\"hljs-built_in\">super</span>().__new__(cls)\n            cls._instance._initialized = <span class=\"hljs-literal\">False</span>\n        <span class=\"hljs-keyword\">return</span> cls._instance\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-variable language_\">self</span>._initialized:\n            <span class=\"hljs-keyword\">return</span>\n        <span class=\"hljs-variable language_\">self</span>.connection = <span class=\"hljs-string\">&quot;db_connection&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>._initialized = <span class=\"hljs-literal\">True</span>\n\n<span class=\"hljs-comment\"># &#x65b9;&#x5f0f; 2&#xff1a;&#x88c5;&#x9970;&#x5668;&#x5b9e;&#x73b0;</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">singleton</span>(<span class=\"hljs-params\">cls</span>):\n    instances = {}\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_instance</span>(<span class=\"hljs-params\">*args, **kwargs</span>):\n        <span class=\"hljs-keyword\">if</span> cls <span class=\"hljs-keyword\">not</span> <span class=\"hljs-keyword\">in</span> instances:\n            instances[cls] = cls(*args, **kwargs)\n        <span class=\"hljs-keyword\">return</span> instances[cls]\n    <span class=\"hljs-keyword\">return</span> get_instance\n\n<span class=\"hljs-meta\">@singleton</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Config</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.settings = {<span class=\"hljs-string\">&quot;debug&quot;</span>: <span class=\"hljs-literal\">True</span>}\n\n<span class=\"hljs-comment\"># &#x4f7f;&#x7528;</span>\ndb1 = DatabaseConnection()\ndb2 = DatabaseConnection()\n<span class=\"hljs-built_in\">print</span>(db1 <span class=\"hljs-keyword\">is</span> db2)  <span class=\"hljs-comment\"># True</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"104,140"}}],"payload":{"tag":"h3","lines":"78,79"}},{"content":"<svg width=\"16\" height=\"16\" viewBox=\"0 -3 24 24\"><path d=\"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z\"/></svg> <strong>&#x5efa;&#x9020;&#x8005;&#x6a21;&#x5f0f;&#xff08;Builder Pattern&#xff09;</strong>","children":[{"content":"<pre data-lines=\"169,217\"><code class=\"language-python\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">QueryBuilder</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>._table: <span class=\"hljs-type\">Optional</span>[<span class=\"hljs-built_in\">str</span>] = <span class=\"hljs-literal\">None</span>\n        <span class=\"hljs-variable language_\">self</span>._fields: <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">str</span>] = []\n        <span class=\"hljs-variable language_\">self</span>._where: <span class=\"hljs-type\">Optional</span>[<span class=\"hljs-built_in\">str</span>] = <span class=\"hljs-literal\">None</span>\n        <span class=\"hljs-variable language_\">self</span>._limit: <span class=\"hljs-type\">Optional</span>[<span class=\"hljs-built_in\">int</span>] = <span class=\"hljs-literal\">None</span>\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">table</span>(<span class=\"hljs-params\">self, name: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-string\">&quot;QueryBuilder&quot;</span>:\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x8bbe;&#x7f6e;&#x8868;&#x540d;&#xff08;&#x8fd4;&#x56de; self &#x652f;&#x6301;&#x94fe;&#x5f0f;&#x8c03;&#x7528;&#xff09;&quot;&quot;&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>._table = name\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">self</span>\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">select</span>(<span class=\"hljs-params\">self, *fields: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-string\">&quot;QueryBuilder&quot;</span>:\n        <span class=\"hljs-variable language_\">self</span>._fields.extend(fields)\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">self</span>\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">where</span>(<span class=\"hljs-params\">self, condition: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-string\">&quot;QueryBuilder&quot;</span>:\n        <span class=\"hljs-variable language_\">self</span>._where = condition\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">self</span>\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">limit</span>(<span class=\"hljs-params\">self, count: <span class=\"hljs-built_in\">int</span></span>) -&gt; <span class=\"hljs-string\">&quot;QueryBuilder&quot;</span>:\n        <span class=\"hljs-variable language_\">self</span>._limit = count\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">self</span>\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">build</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x6784;&#x5efa; SQL &#x67e5;&#x8be2;&quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> <span class=\"hljs-variable language_\">self</span>._table:\n            <span class=\"hljs-keyword\">raise</span> ValueError(<span class=\"hljs-string\">&quot;&#x5fc5;&#x987b;&#x6307;&#x5b9a;&#x8868;&#x540d;&quot;</span>)\n        \n        sql = <span class=\"hljs-string\">f&quot;SELECT <span class=\"hljs-subst\">{<span class=\"hljs-string\">&apos;, &apos;</span>.join(self._fields <span class=\"hljs-keyword\">or</span> [<span class=\"hljs-string\">&apos;*&apos;</span>])}</span> FROM <span class=\"hljs-subst\">{self._table}</span>&quot;</span>\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-variable language_\">self</span>._where:\n            sql += <span class=\"hljs-string\">f&quot; WHERE <span class=\"hljs-subst\">{self._where}</span>&quot;</span>\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-variable language_\">self</span>._limit:\n            sql += <span class=\"hljs-string\">f&quot; LIMIT <span class=\"hljs-subst\">{self._limit}</span>&quot;</span>\n        <span class=\"hljs-keyword\">return</span> sql\n\n<span class=\"hljs-comment\"># &#x4f7f;&#x7528;&#xff1a;&#x94fe;&#x5f0f;&#x8c03;&#x7528;</span>\nquery = (\n    QueryBuilder()\n    .table(<span class=\"hljs-string\">&quot;users&quot;</span>)\n    .select(<span class=\"hljs-string\">&quot;id&quot;</span>, <span class=\"hljs-string\">&quot;name&quot;</span>, <span class=\"hljs-string\">&quot;email&quot;</span>)\n    .where(<span class=\"hljs-string\">&quot;age &gt; 18&quot;</span>)\n    .limit(<span class=\"hljs-number\">10</span>)\n    .build()\n)\n<span class=\"hljs-built_in\">print</span>(query)  <span class=\"hljs-comment\"># SELECT id, name, email FROM users WHERE age &gt; 18 LIMIT 10</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"169,217"}}],"payload":{"tag":"h3","lines":"143,144"}}],"payload":{"tag":"h2","lines":"16,17"}},{"content":"<strong>2. &#x7ed3;&#x6784;&#x578b;&#x6a21;&#x5f0f;</strong>","children":[{"content":"<svg width=\"16\" height=\"16\" viewBox=\"0 -3 24 24\"><path d=\"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z\"/></svg> <strong>Mixin &#x6a21;&#x5f0f;</strong>","children":[{"content":"<pre data-lines=\"248,279\"><code class=\"language-python\"><span class=\"hljs-keyword\">from</span> datetime <span class=\"hljs-keyword\">import</span> datetime\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TimestampMixin</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x65f6;&#x95f4;&#x6233; Mixin&quot;&quot;&quot;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, *args, **kwargs</span>):\n        <span class=\"hljs-built_in\">super</span>().__init__(*args, **kwargs)\n        <span class=\"hljs-variable language_\">self</span>.created_at = datetime.now()\n        <span class=\"hljs-variable language_\">self</span>.updated_at = datetime.now()\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">touch</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x66f4;&#x65b0;&#x4fee;&#x6539;&#x65f6;&#x95f4;&quot;&quot;&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>.updated_at = datetime.now()\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SerializeMixin</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x5e8f;&#x5217;&#x5316; Mixin&quot;&quot;&quot;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">to_dict</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">dict</span>:\n        <span class=\"hljs-keyword\">return</span> {k: v <span class=\"hljs-keyword\">for</span> k, v <span class=\"hljs-keyword\">in</span> <span class=\"hljs-variable language_\">self</span>.__dict__.items() \n                <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> k.startswith(<span class=\"hljs-string\">&apos;_&apos;</span>)}\n\n<span class=\"hljs-comment\"># &#x4f7f;&#x7528; Mixin</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">User</span>(TimestampMixin, SerializeMixin):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, name: <span class=\"hljs-built_in\">str</span>, email: <span class=\"hljs-built_in\">str</span></span>):\n        <span class=\"hljs-built_in\">super</span>().__init__()  <span class=\"hljs-comment\"># &#x8c03;&#x7528; Mixin &#x7684; __init__</span>\n        <span class=\"hljs-variable language_\">self</span>.name = name\n        <span class=\"hljs-variable language_\">self</span>.email = email\n\nuser = User(<span class=\"hljs-string\">&quot;Alice&quot;</span>, <span class=\"hljs-string\">&quot;alice@example.com&quot;</span>)\n<span class=\"hljs-built_in\">print</span>(user.created_at)  <span class=\"hljs-comment\"># &#x81ea;&#x52a8;&#x6709;&#x65f6;&#x95f4;&#x6233;</span>\n<span class=\"hljs-built_in\">print</span>(user.to_dict())   <span class=\"hljs-comment\"># &#x81ea;&#x52a8;&#x6709;&#x5e8f;&#x5217;&#x5316;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"248,279"}}],"payload":{"tag":"h3","lines":"222,223"}},{"content":"<svg width=\"16\" height=\"16\" viewBox=\"0 -3 24 24\"><path d=\"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z\"/></svg> <strong>&#x534f;&#x8bae;&#x6a21;&#x5f0f;&#xff08;Protocol Pattern&#xff09;</strong>","children":[{"content":"<pre data-lines=\"309,337\"><code class=\"language-python\"><span class=\"hljs-keyword\">from</span> typing <span class=\"hljs-keyword\">import</span> Protocol, <span class=\"hljs-type\">Optional</span>\n\n<span class=\"hljs-comment\"># 1. &#x5b9a;&#x4e49;&#x534f;&#x8bae;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TaskQueue</span>(<span class=\"hljs-title class_ inherited__\">Protocol</span>):\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x4efb;&#x52a1;&#x961f;&#x5217;&#x534f;&#x8bae;&#xff08;&#x63a5;&#x53e3;&#x89c4;&#x8303;&#xff09;&quot;&quot;&quot;</span>\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">add_task</span>(<span class=\"hljs-params\">self, task: Task</span>) -&gt; <span class=\"hljs-literal\">None</span>: ...\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_task</span>(<span class=\"hljs-params\">self, task_id: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-type\">Optional</span>[Task]: ...\n\n<span class=\"hljs-comment\"># 2. &#x5b9e;&#x73b0;&#x7c7b;&#xff08;&#x65e0;&#x9700;&#x7ee7;&#x627f;&#xff09;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MemoryQueue</span>:\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">add_task</span>(<span class=\"hljs-params\">self, task: Task</span>) -&gt; <span class=\"hljs-literal\">None</span>:\n        <span class=\"hljs-comment\"># &#x5b9e;&#x73b0;...</span>\n        <span class=\"hljs-keyword\">pass</span>\n    \n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_task</span>(<span class=\"hljs-params\">self, task_id: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-type\">Optional</span>[Task]:\n        <span class=\"hljs-comment\"># &#x5b9e;&#x73b0;...</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n<span class=\"hljs-comment\"># 3. &#x7c7b;&#x578b;&#x68c0;&#x67e5;</span>\n<span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_queue</span>(<span class=\"hljs-params\">queue: TaskQueue</span>):\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x63a5;&#x53d7;&#x4efb;&#x4f55;&#x5b9e;&#x73b0;&#x4e86; TaskQueue &#x534f;&#x8bae;&#x7684;&#x5bf9;&#x8c61;&quot;&quot;&quot;</span>\n    <span class=\"hljs-keyword\">await</span> queue.add_task(task)  <span class=\"hljs-comment\"># &#x2705; mypy &#x77e5;&#x9053;&#x6709; add_task &#x65b9;&#x6cd5;</span>\n    \n<span class=\"hljs-comment\"># MemoryQueue &#x65e0;&#x9700;&#x7ee7;&#x627f; TaskQueue&#xff0c;mypy &#x4e5f;&#x80fd;&#x8bc6;&#x522b;</span>\nmemory_queue = MemoryQueue()\n<span class=\"hljs-keyword\">await</span> process_queue(memory_queue)  <span class=\"hljs-comment\"># &#x2705; &#x7c7b;&#x578b;&#x68c0;&#x67e5;&#x901a;&#x8fc7;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"309,337"}}],"payload":{"tag":"h3","lines":"282,283"}},{"content":"<svg width=\"16\" height=\"16\" viewBox=\"0 -3 24 24\"><path d=\"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z\"/></svg> <strong>&#x9002;&#x914d;&#x5668;&#x6a21;&#x5f0f;&#xff08;Adapter Pattern&#xff09;</strong>","children":[{"content":"<pre data-lines=\"365,397\"><code class=\"language-python\"><span class=\"hljs-keyword\">from</span> typing <span class=\"hljs-keyword\">import</span> Protocol\n\n<span class=\"hljs-comment\"># 1. &#x76ee;&#x6807;&#x63a5;&#x53e3;&#xff1a;&#x6211;&#x4eec;&#x671f;&#x671b;&#x7684;&#x7edf;&#x4e00;&#x63a5;&#x53e3;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Logger</span>(<span class=\"hljs-title class_ inherited__\">Protocol</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">log</span>(<span class=\"hljs-params\">self, level: <span class=\"hljs-built_in\">str</span>, message: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-literal\">None</span>: ...\n\n<span class=\"hljs-comment\"># 2. &#x88ab;&#x9002;&#x914d;&#x8005; A&#xff08;&#x63a5;&#x53e3;&#x4e0d;&#x540c;&#xff09;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ThirdPartyLoggerA</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">write_log</span>(<span class=\"hljs-params\">self, msg: <span class=\"hljs-built_in\">str</span>, severity: <span class=\"hljs-built_in\">int</span></span>) -&gt; <span class=\"hljs-literal\">None</span>:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;[LoggerA] Severity <span class=\"hljs-subst\">{severity}</span>: <span class=\"hljs-subst\">{msg}</span>&quot;</span>)\n\n<span class=\"hljs-comment\"># 3. &#x9002;&#x914d;&#x5668; A&#xff1a;&#x5c06; ThirdPartyLoggerA &#x9002;&#x914d;&#x4e3a; Logger</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">LoggerAdapterA</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, logger: ThirdPartyLoggerA</span>):\n        <span class=\"hljs-variable language_\">self</span>.logger = logger\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">log</span>(<span class=\"hljs-params\">self, level: <span class=\"hljs-built_in\">str</span>, message: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-literal\">None</span>:\n        <span class=\"hljs-comment\"># &#x8f6c;&#x6362;&#xff1a;level &#x5b57;&#x7b26;&#x4e32; -&gt; severity &#x6570;&#x5b57;</span>\n        severity_map = {<span class=\"hljs-string\">&quot;DEBUG&quot;</span>: <span class=\"hljs-number\">0</span>, <span class=\"hljs-string\">&quot;INFO&quot;</span>: <span class=\"hljs-number\">1</span>, <span class=\"hljs-string\">&quot;WARNING&quot;</span>: <span class=\"hljs-number\">2</span>, <span class=\"hljs-string\">&quot;ERROR&quot;</span>: <span class=\"hljs-number\">3</span>}\n        severity = severity_map.get(level.upper(), <span class=\"hljs-number\">1</span>)\n        <span class=\"hljs-variable language_\">self</span>.logger.write_log(message, severity)\n\n<span class=\"hljs-comment\"># 4. &#x4f7f;&#x7528;&#x7edf;&#x4e00;&#x63a5;&#x53e3;</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">use_logger</span>(<span class=\"hljs-params\">logger: Logger</span>):\n    logger.log(<span class=\"hljs-string\">&quot;INFO&quot;</span>, <span class=\"hljs-string\">&quot;&#x5e94;&#x7528;&#x542f;&#x52a8;&quot;</span>)\n    logger.log(<span class=\"hljs-string\">&quot;ERROR&quot;</span>, <span class=\"hljs-string\">&quot;&#x53d1;&#x751f;&#x9519;&#x8bef;&quot;</span>)\n\n<span class=\"hljs-comment\"># &#x9002;&#x914d;&#x7b2c;&#x4e09;&#x65b9;&#x5e93;</span>\nadapter = LoggerAdapterA(ThirdPartyLoggerA())\nuse_logger(adapter)  <span class=\"hljs-comment\"># &#x2705; &#x7edf;&#x4e00;&#x63a5;&#x53e3;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"365,397"}}],"payload":{"tag":"h3","lines":"340,341"}},{"content":"<svg width=\"16\" height=\"16\" viewBox=\"0 -3 24 24\"><path d=\"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z\"/></svg> <strong>&#x5916;&#x89c2;&#x6a21;&#x5f0f;&#xff08;Facade Pattern&#xff09;</strong>","children":[{"content":"<pre data-lines=\"431,523\"><code class=\"language-python\"><span class=\"hljs-comment\"># &#x590d;&#x6742;&#x7684;&#x5b50;&#x7cfb;&#x7edf;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">VideoFile</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x89c6;&#x9891;&#x6587;&#x4ef6;&#x7c7b;&quot;&quot;&quot;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, filename: <span class=\"hljs-built_in\">str</span></span>):\n        <span class=\"hljs-variable language_\">self</span>.filename = filename\n        <span class=\"hljs-variable language_\">self</span>.codec_type = <span class=\"hljs-variable language_\">self</span>._detect_codec()\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">_detect_codec</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-comment\"># &#x590d;&#x6742;&#x7684;&#x7f16;&#x89e3;&#x7801;&#x5668;&#x68c0;&#x6d4b;&#x903b;&#x8f91;</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&quot;h264&quot;</span>\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">AudioMixer</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x97f3;&#x9891;&#x6df7;&#x5408;&#x5668;&quot;&quot;&quot;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">fix</span>(<span class=\"hljs-params\">self, video: VideoFile</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-comment\"># &#x590d;&#x6742;&#x7684;&#x97f3;&#x9891;&#x5904;&#x7406;&#x903b;&#x8f91;</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&quot;fixed_audio&quot;</span>\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">BitrateReader</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x6bd4;&#x7279;&#x7387;&#x8bfb;&#x53d6;&#x5668;&quot;&quot;&quot;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">read</span>(<span class=\"hljs-params\">self, video: VideoFile</span>) -&gt; <span class=\"hljs-built_in\">int</span>:\n        <span class=\"hljs-comment\"># &#x590d;&#x6742;&#x7684;&#x6bd4;&#x7279;&#x7387;&#x8ba1;&#x7b97;</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">1920</span>\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CodecFactory</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x7f16;&#x89e3;&#x7801;&#x5668;&#x5de5;&#x5382;&quot;&quot;&quot;</span>\n<span class=\"hljs-meta\">    @staticmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">extract</span>(<span class=\"hljs-params\">video: VideoFile</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-comment\"># &#x6839;&#x636e;&#x89c6;&#x9891;&#x7c7b;&#x578b;&#x63d0;&#x53d6;&#x7f16;&#x89e3;&#x7801;&#x5668;</span>\n        <span class=\"hljs-keyword\">return</span> video.codec_type\n\n<span class=\"hljs-comment\"># &#x5916;&#x89c2;&#x7c7b;&#xff1a;&#x7b80;&#x5316;&#x63a5;&#x53e3;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">VideoConverter</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x89c6;&#x9891;&#x8f6c;&#x6362;&#x5916;&#x89c2;\n    \n    &#x9690;&#x85cf;&#x4e86;&#x89c6;&#x9891;&#x8f6c;&#x6362;&#x7684;&#x6240;&#x6709;&#x590d;&#x6742;&#x7ec6;&#x8282;&#xff1a;\n    - &#x7f16;&#x89e3;&#x7801;&#x5668;&#x68c0;&#x6d4b;&#x548c;&#x63d0;&#x53d6;\n    - &#x97f3;&#x9891;&#x5904;&#x7406;\n    - &#x6bd4;&#x7279;&#x7387;&#x8c03;&#x6574;\n    - &#x683c;&#x5f0f;&#x8f6c;&#x6362;\n    \n    &#x5bf9;&#x5916;&#x53ea;&#x63d0;&#x4f9b;&#x4e00;&#x4e2a;&#x7b80;&#x5355;&#x7684; convert &#x65b9;&#x6cd5;\n    &quot;&quot;&quot;</span>\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">convert</span>(<span class=\"hljs-params\">self, filename: <span class=\"hljs-built_in\">str</span>, target_format: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x8f6c;&#x6362;&#x89c6;&#x9891;&#x683c;&#x5f0f;&#xff08;&#x4e00;&#x884c;&#x4ee3;&#x7801;&#x641e;&#x5b9a;&#xff09;\n        \n        Args:\n            filename: &#x6e90;&#x6587;&#x4ef6;&#x540d;\n            target_format: &#x76ee;&#x6807;&#x683c;&#x5f0f;&#xff08;&quot;mp4&quot;, &quot;avi&quot;, &quot;mkv&quot; &#x7b49;&#xff09;\n        \n        Returns:\n            &#x8f6c;&#x6362;&#x540e;&#x7684;&#x6587;&#x4ef6;&#x540d;\n        &quot;&quot;&quot;</span>\n        <span class=\"hljs-comment\"># &#x5185;&#x90e8;&#x534f;&#x8c03;&#x591a;&#x4e2a;&#x590d;&#x6742;&#x5b50;&#x7cfb;&#x7edf;</span>\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;&#x5f00;&#x59cb;&#x8f6c;&#x6362; <span class=\"hljs-subst\">{filename}</span> -&gt; <span class=\"hljs-subst\">{target_format}</span>&quot;</span>)\n        \n        <span class=\"hljs-comment\"># 1. &#x52a0;&#x8f7d;&#x89c6;&#x9891;</span>\n        video = VideoFile(filename)\n        \n        <span class=\"hljs-comment\"># 2. &#x63d0;&#x53d6;&#x7f16;&#x89e3;&#x7801;&#x5668;</span>\n        codec = CodecFactory.extract(video)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;&#x68c0;&#x6d4b;&#x5230;&#x7f16;&#x89e3;&#x7801;&#x5668;: <span class=\"hljs-subst\">{codec}</span>&quot;</span>)\n        \n        <span class=\"hljs-comment\"># 3. &#x5904;&#x7406;&#x97f3;&#x9891;</span>\n        audio = AudioMixer().fix(video)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;&#x97f3;&#x9891;&#x5904;&#x7406;&#x5b8c;&#x6210;: <span class=\"hljs-subst\">{audio}</span>&quot;</span>)\n        \n        <span class=\"hljs-comment\"># 4. &#x8bfb;&#x53d6;&#x6bd4;&#x7279;&#x7387;</span>\n        bitrate = BitrateReader().read(video)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;&#x6bd4;&#x7279;&#x7387;: <span class=\"hljs-subst\">{bitrate}</span>&quot;</span>)\n        \n        <span class=\"hljs-comment\"># 5. &#x6267;&#x884c;&#x8f6c;&#x6362;&#xff08;&#x5b9e;&#x9645;&#x9879;&#x76ee;&#x4e2d;&#x4f1a;&#x8c03;&#x7528; ffmpeg &#x7b49;&#xff09;</span>\n        output = filename.rsplit(<span class=\"hljs-string\">&quot;.&quot;</span>, <span class=\"hljs-number\">1</span>)[<span class=\"hljs-number\">0</span>] + <span class=\"hljs-string\">f&quot;.<span class=\"hljs-subst\">{target_format}</span>&quot;</span>\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;&#x8f6c;&#x6362;&#x5b8c;&#x6210;: <span class=\"hljs-subst\">{output}</span>&quot;</span>)\n        \n        <span class=\"hljs-keyword\">return</span> output\n\n<span class=\"hljs-comment\"># &#x4f7f;&#x7528;&#xff1a;&#x975e;&#x5e38;&#x7b80;&#x5355;&#xff01;</span>\nconverter = VideoConverter()\n\n<span class=\"hljs-comment\"># &#x2705; &#x4e00;&#x884c;&#x4ee3;&#x7801;&#x5b8c;&#x6210;&#x590d;&#x6742;&#x7684;&#x89c6;&#x9891;&#x8f6c;&#x6362;</span>\nconverter.convert(<span class=\"hljs-string\">&quot;movie.avi&quot;</span>, <span class=\"hljs-string\">&quot;mp4&quot;</span>)\nconverter.convert(<span class=\"hljs-string\">&quot;video.mkv&quot;</span>, <span class=\"hljs-string\">&quot;avi&quot;</span>)\n\n<span class=\"hljs-comment\"># &#x5982;&#x679c;&#x6ca1;&#x6709;&#x5916;&#x89c2;&#xff0c;&#x7528;&#x6237;&#x9700;&#x8981;&#xff1a;</span>\n<span class=\"hljs-comment\"># video = VideoFile(&quot;movie.avi&quot;)</span>\n<span class=\"hljs-comment\"># codec = CodecFactory.extract(video)</span>\n<span class=\"hljs-comment\"># audio = AudioMixer().fix(video)</span>\n<span class=\"hljs-comment\"># bitrate = BitrateReader().read(video)</span>\n<span class=\"hljs-comment\"># ... &#x81ea;&#x5df1;&#x534f;&#x8c03;&#x6240;&#x6709;&#x6b65;&#x9aa4;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"431,523"}},{"content":"<pre data-lines=\"525,567\"><code class=\"language-python\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">OrderFacade</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x8ba2;&#x5355;&#x5904;&#x7406;&#x5916;&#x89c2;&quot;&quot;&quot;</span>\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-comment\"># &#x5185;&#x90e8;&#x4f9d;&#x8d56;&#x591a;&#x4e2a;&#x5b50;&#x7cfb;&#x7edf;</span>\n        <span class=\"hljs-variable language_\">self</span>.inventory = InventoryService()\n        <span class=\"hljs-variable language_\">self</span>.payment = PaymentService()\n        <span class=\"hljs-variable language_\">self</span>.shipping = ShippingService()\n        <span class=\"hljs-variable language_\">self</span>.notification = NotificationService()\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">place_order</span>(<span class=\"hljs-params\">self, user_id: <span class=\"hljs-built_in\">str</span>, items: <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">str</span>]</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x4e0b;&#x5355;&#xff08;&#x4e00;&#x884c;&#x4ee3;&#x7801;&#x5b8c;&#x6210;&#xff09;\n        \n        &#x5185;&#x90e8;&#x534f;&#x8c03;&#xff1a;\n        1. &#x68c0;&#x67e5;&#x5e93;&#x5b58;\n        2. &#x5904;&#x7406;&#x652f;&#x4ed8;\n        3. &#x521b;&#x5efa;&#x53d1;&#x8d27;&#x5355;\n        4. &#x53d1;&#x9001;&#x901a;&#x77e5;\n        &quot;&quot;&quot;</span>\n        <span class=\"hljs-comment\"># 1. &#x68c0;&#x67e5;&#x5e93;&#x5b58;</span>\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> <span class=\"hljs-variable language_\">self</span>.inventory.check_available(items):\n            <span class=\"hljs-keyword\">raise</span> ValueError(<span class=\"hljs-string\">&quot;&#x5e93;&#x5b58;&#x4e0d;&#x8db3;&quot;</span>)\n        \n        <span class=\"hljs-comment\"># 2. &#x5904;&#x7406;&#x652f;&#x4ed8;</span>\n        order_id = <span class=\"hljs-variable language_\">self</span>.payment.charge(user_id, items)\n        \n        <span class=\"hljs-comment\"># 3. &#x51cf;&#x5c11;&#x5e93;&#x5b58;</span>\n        <span class=\"hljs-variable language_\">self</span>.inventory.decrease(items)\n        \n        <span class=\"hljs-comment\"># 4. &#x521b;&#x5efa;&#x53d1;&#x8d27;&#x5355;</span>\n        <span class=\"hljs-variable language_\">self</span>.shipping.create_shipment(order_id, items)\n        \n        <span class=\"hljs-comment\"># 5. &#x53d1;&#x9001;&#x901a;&#x77e5;</span>\n        <span class=\"hljs-variable language_\">self</span>.notification.send_order_confirmation(user_id, order_id)\n        \n        <span class=\"hljs-keyword\">return</span> order_id\n\n<span class=\"hljs-comment\"># &#x4f7f;&#x7528;&#xff1a;&#x5916;&#x90e8;&#x8c03;&#x7528;&#x975e;&#x5e38;&#x7b80;&#x5355;</span>\nfacade = OrderFacade()\norder_id = facade.place_order(<span class=\"hljs-string\">&quot;user-123&quot;</span>, [<span class=\"hljs-string\">&quot;item-1&quot;</span>, <span class=\"hljs-string\">&quot;item-2&quot;</span>])\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"525,567"}}],"payload":{"tag":"h3","lines":"400,401"}},{"content":"<svg width=\"16\" height=\"16\" viewBox=\"0 -3 24 24\"><path d=\"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z\"/></svg> <strong>&#x4f9d;&#x8d56;&#x6ce8;&#x5165;&#xff08;Dependency Injection&#xff09;</strong> &#x2b50;&#x2b50;&#x2b50;","children":[{"content":"<pre data-lines=\"607,663\"><code class=\"language-python\"><span class=\"hljs-keyword\">from</span> typing <span class=\"hljs-keyword\">import</span> Protocol\n\n<span class=\"hljs-comment\"># 1. &#x5b9a;&#x4e49;&#x4f9d;&#x8d56;&#x63a5;&#x53e3;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TaskQueue</span>(<span class=\"hljs-title class_ inherited__\">Protocol</span>):\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x4efb;&#x52a1;&#x961f;&#x5217;&#x63a5;&#x53e3;&#xff08;&#x4f9d;&#x8d56;&#x62bd;&#x8c61;&#xff09;&quot;&quot;&quot;</span>\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">add_task</span>(<span class=\"hljs-params\">self, task: Task</span>) -&gt; <span class=\"hljs-literal\">None</span>: ...\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_pending_tasks</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">list</span>[Task]: ...\n\n<span class=\"hljs-comment\"># 2. &#x5177;&#x4f53;&#x5b9e;&#x73b0;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SQLiteTaskQueue</span>:\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">add_task</span>(<span class=\"hljs-params\">self, task: Task</span>) -&gt; <span class=\"hljs-literal\">None</span>:\n        <span class=\"hljs-comment\"># SQLite &#x5b9e;&#x73b0;</span>\n        <span class=\"hljs-keyword\">pass</span>\n    \n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_pending_tasks</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">list</span>[Task]:\n        <span class=\"hljs-comment\"># SQLite &#x5b9e;&#x73b0;</span>\n        <span class=\"hljs-keyword\">return</span> []\n\n<span class=\"hljs-comment\"># 3. &#x4f9d;&#x8d56;&#x6ce8;&#x5165;&#xff08;&#x6784;&#x9020;&#x51fd;&#x6570;&#x6ce8;&#x5165;&#xff09;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TaskWorker</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x4efb;&#x52a1;&#x5de5;&#x4f5c;&#x5668;\n    \n    &#x2705; &#x597d;&#x7684;&#x8bbe;&#x8ba1;&#xff1a;&#x4f9d;&#x8d56;&#x4ece;&#x5916;&#x90e8;&#x6ce8;&#x5165;\n    - &#x4e0d;&#x5173;&#x5fc3; queue &#x662f; SQLite &#x8fd8;&#x662f; Redis\n    - &#x53ef;&#x4ee5;&#x8f7b;&#x677e;&#x5207;&#x6362;&#x5b9e;&#x73b0;\n    - &#x53ef;&#x4ee5;&#x6ce8;&#x5165; mock &#x5bf9;&#x8c61;&#x6d4b;&#x8bd5;\n    &quot;&quot;&quot;</span>\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, queue: TaskQueue</span>):  <span class=\"hljs-comment\"># &#x1f525; &#x4f9d;&#x8d56;&#x6ce8;&#x5165;&#xff01;</span>\n        <span class=\"hljs-variable language_\">self</span>.queue = queue  <span class=\"hljs-comment\"># &#x4ece;&#x5916;&#x90e8;&#x4f20;&#x5165;&#xff0c;&#x4e0d;&#x5728;&#x5185;&#x90e8;&#x521b;&#x5efa;</span>\n    \n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x5904;&#x7406;&#x4efb;&#x52a1;&quot;&quot;&quot;</span>\n        tasks = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-variable language_\">self</span>.queue.get_pending_tasks()\n        <span class=\"hljs-keyword\">for</span> task <span class=\"hljs-keyword\">in</span> tasks:\n            <span class=\"hljs-comment\"># &#x5904;&#x7406;&#x4efb;&#x52a1;...</span>\n            <span class=\"hljs-keyword\">pass</span>\n\n<span class=\"hljs-comment\"># 4. &#x4f7f;&#x7528;&#xff1a;&#x5728;&#x5916;&#x90e8;&#x521b;&#x5efa;&#x4f9d;&#x8d56;&#x5e76;&#x6ce8;&#x5165;</span>\n<span class=\"hljs-comment\"># &#x751f;&#x4ea7;&#x73af;&#x5883;</span>\nprod_queue = SQLiteTaskQueue(db_path=<span class=\"hljs-string\">&quot;prod.db&quot;</span>)\nprod_worker = TaskWorker(prod_queue)  <span class=\"hljs-comment\"># &#x6ce8;&#x5165; SQLite &#x961f;&#x5217;</span>\n\n<span class=\"hljs-comment\"># &#x6d4b;&#x8bd5;&#x73af;&#x5883;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MockQueue</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x6d4b;&#x8bd5;&#x7528;&#x7684; mock &#x961f;&#x5217;&quot;&quot;&quot;</span>\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">add_task</span>(<span class=\"hljs-params\">self, task: Task</span>) -&gt; <span class=\"hljs-literal\">None</span>:\n        <span class=\"hljs-keyword\">pass</span>\n    \n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_pending_tasks</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">list</span>[Task]:\n        <span class=\"hljs-keyword\">return</span> [Task(<span class=\"hljs-built_in\">id</span>=<span class=\"hljs-string\">&quot;test-1&quot;</span>, name=<span class=\"hljs-string\">&quot;&#x6d4b;&#x8bd5;&#x4efb;&#x52a1;&quot;</span>)]\n\ntest_queue = MockQueue()\ntest_worker = TaskWorker(test_queue)  <span class=\"hljs-comment\"># &#x6ce8;&#x5165; mock &#x961f;&#x5217;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"607,663"}},{"content":"<pre data-lines=\"665,676\"><code class=\"language-python\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TaskWorker</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x274c; &#x574f;&#x7684;&#x8bbe;&#x8ba1;&#xff1a;&#x5185;&#x90e8;&#x521b;&#x5efa;&#x4f9d;&#x8d56;&quot;&quot;&quot;</span>\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.queue = SQLiteTaskQueue()  <span class=\"hljs-comment\"># &#x274c; &#x786c;&#x7f16;&#x7801;&#x4f9d;&#x8d56;</span>\n        <span class=\"hljs-comment\"># &#x95ee;&#x9898;&#xff1a;</span>\n        <span class=\"hljs-comment\"># 1. &#x65e0;&#x6cd5;&#x5207;&#x6362;&#x5230; Redis</span>\n        <span class=\"hljs-comment\"># 2. &#x65e0;&#x6cd5;&#x6d4b;&#x8bd5;&#xff08;&#x65e0;&#x6cd5;&#x6ce8;&#x5165; mock&#xff09;</span>\n        <span class=\"hljs-comment\"># 3. &#x4e0e; SQLiteTaskQueue &#x5f3a;&#x8026;&#x5408;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"665,676"}},{"content":"<pre data-lines=\"678,699\"><code class=\"language-python\"><span class=\"hljs-keyword\">import</span> pytest\n<span class=\"hljs-keyword\">from</span> unittest.mock <span class=\"hljs-keyword\">import</span> AsyncMock\n\n<span class=\"hljs-meta\">@pytest.mark.asyncio</span>\n<span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">test_process_tasks</span>():\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x6d4b;&#x8bd5;&#x4efb;&#x52a1;&#x5904;&#x7406;&#xff08;&#x4f7f;&#x7528; mock &#x4f9d;&#x8d56;&#xff09;&quot;&quot;&quot;</span>\n    \n    <span class=\"hljs-comment\"># &#x521b;&#x5efa; mock &#x961f;&#x5217;</span>\n    mock_queue = AsyncMock()\n    mock_queue.get_pending_tasks.return_value = [\n        Task(<span class=\"hljs-built_in\">id</span>=<span class=\"hljs-string\">&quot;test-1&quot;</span>, name=<span class=\"hljs-string\">&quot;&#x6d4b;&#x8bd5;&#x4efb;&#x52a1;&quot;</span>)\n    ]\n    \n    <span class=\"hljs-comment\"># &#x6ce8;&#x5165; mock &#x4f9d;&#x8d56;</span>\n    worker = TaskWorker(mock_queue)\n    <span class=\"hljs-keyword\">await</span> worker.process()\n    \n    <span class=\"hljs-comment\"># &#x9a8c;&#x8bc1;</span>\n    <span class=\"hljs-keyword\">assert</span> mock_queue.get_pending_tasks.called\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"678,699"}}],"payload":{"tag":"h3","lines":"570,571"}},{"content":"<svg width=\"16\" height=\"16\" viewBox=\"0 -3 24 24\"><path d=\"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z\"/></svg> <strong>&#x4ed3;&#x50a8;&#x6a21;&#x5f0f;&#xff08;Repository Pattern&#xff09;</strong> &#x2b50;&#x2b50;","children":[{"content":"<pre data-lines=\"739,822\"><code class=\"language-python\"><span class=\"hljs-keyword\">from</span> typing <span class=\"hljs-keyword\">import</span> Protocol, <span class=\"hljs-type\">Optional</span>\n<span class=\"hljs-keyword\">from</span> dataclasses <span class=\"hljs-keyword\">import</span> dataclass\n\n<span class=\"hljs-comment\"># 1. &#x5b9e;&#x4f53;&#x5bf9;&#x8c61;</span>\n<span class=\"hljs-meta\">@dataclass</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">User</span>:\n    <span class=\"hljs-built_in\">id</span>: <span class=\"hljs-built_in\">str</span>\n    email: <span class=\"hljs-built_in\">str</span>\n    name: <span class=\"hljs-built_in\">str</span>\n\n<span class=\"hljs-comment\"># 2. &#x4ed3;&#x50a8;&#x63a5;&#x53e3;&#xff08;Protocol&#xff09;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">UserRepository</span>(<span class=\"hljs-title class_ inherited__\">Protocol</span>):\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x7528;&#x6237;&#x4ed3;&#x50a8;&#x63a5;&#x53e3;\n    \n    &#x63d0;&#x4f9b;&#x7c7b;&#x4f3c;&#x96c6;&#x5408;&#x7684;&#x64cd;&#x4f5c;&#x63a5;&#x53e3;&#xff1a;\n    - &#x67e5;&#x8be2;&#xff1a;find_by_id, find_by_email, find_all\n    - &#x4fee;&#x6539;&#xff1a;save, delete\n    &quot;&quot;&quot;</span>\n    \n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">find_by_id</span>(<span class=\"hljs-params\">self, user_id: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-type\">Optional</span>[User]: ...\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">find_by_email</span>(<span class=\"hljs-params\">self, email: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-type\">Optional</span>[User]: ...\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">find_all</span>(<span class=\"hljs-params\">self, limit: <span class=\"hljs-built_in\">int</span> = <span class=\"hljs-number\">100</span></span>) -&gt; <span class=\"hljs-built_in\">list</span>[User]: ...\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">save</span>(<span class=\"hljs-params\">self, user: User</span>) -&gt; <span class=\"hljs-literal\">None</span>: ...\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">delete</span>(<span class=\"hljs-params\">self, user_id: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-literal\">None</span>: ...\n\n<span class=\"hljs-comment\"># 3. &#x5177;&#x4f53;&#x5b9e;&#x73b0;&#xff1a;SQLite &#x4ed3;&#x50a8;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SQLiteUserRepository</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;SQLite &#x7528;&#x6237;&#x4ed3;&#x50a8;&quot;&quot;&quot;</span>\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, db_path: <span class=\"hljs-built_in\">str</span></span>):\n        <span class=\"hljs-variable language_\">self</span>.db_path = db_path\n    \n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">find_by_id</span>(<span class=\"hljs-params\">self, user_id: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-type\">Optional</span>[User]:\n        <span class=\"hljs-comment\"># SELECT * FROM users WHERE id = ?</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n    \n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">save</span>(<span class=\"hljs-params\">self, user: User</span>) -&gt; <span class=\"hljs-literal\">None</span>:\n        <span class=\"hljs-comment\"># INSERT OR REPLACE INTO users ...</span>\n        <span class=\"hljs-keyword\">pass</span>\n    \n    <span class=\"hljs-comment\"># ... &#x5176;&#x4ed6;&#x65b9;&#x6cd5;</span>\n\n<span class=\"hljs-comment\"># 4. &#x4e1a;&#x52a1;&#x5c42;&#xff1a;&#x53ea;&#x4f9d;&#x8d56;&#x4ed3;&#x50a8;&#x63a5;&#x53e3;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">UserService</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x7528;&#x6237;&#x670d;&#x52a1;&#xff08;&#x4e1a;&#x52a1;&#x5c42;&#xff09;&quot;&quot;&quot;</span>\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, repository: UserRepository</span>):\n        <span class=\"hljs-variable language_\">self</span>.users = repository  <span class=\"hljs-comment\"># &#x4f9d;&#x8d56;&#x6ce8;&#x5165;&#x4ed3;&#x50a8;</span>\n    \n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">register</span>(<span class=\"hljs-params\">self, email: <span class=\"hljs-built_in\">str</span>, name: <span class=\"hljs-built_in\">str</span></span>) -&gt; User:\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x6ce8;&#x518c;&#x7528;&#x6237;&quot;&quot;&quot;</span>\n        <span class=\"hljs-comment\"># 1. &#x68c0;&#x67e5;&#x90ae;&#x7bb1;&#x662f;&#x5426;&#x5b58;&#x5728;</span>\n        existing = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-variable language_\">self</span>.users.find_by_email(email)\n        <span class=\"hljs-keyword\">if</span> existing:\n            <span class=\"hljs-keyword\">raise</span> ValueError(<span class=\"hljs-string\">&quot;&#x90ae;&#x7bb1;&#x5df2;&#x5b58;&#x5728;&quot;</span>)\n        \n        <span class=\"hljs-comment\"># 2. &#x521b;&#x5efa;&#x7528;&#x6237;</span>\n        user = User(<span class=\"hljs-built_in\">id</span>=generate_id(), email=email, name=name)\n        <span class=\"hljs-keyword\">await</span> <span class=\"hljs-variable language_\">self</span>.users.save(user)\n        \n        <span class=\"hljs-keyword\">return</span> user\n\n<span class=\"hljs-comment\"># 5. &#x4f7f;&#x7528;&#xff1a;&#x5207;&#x6362;&#x5b58;&#x50a8;&#x975e;&#x5e38;&#x7b80;&#x5355;</span>\n<span class=\"hljs-comment\"># &#x751f;&#x4ea7;&#x73af;&#x5883;</span>\nsqlite_repo = SQLiteUserRepository(<span class=\"hljs-string\">&quot;prod.db&quot;</span>)\nprod_service = UserService(sqlite_repo)\n\n<span class=\"hljs-comment\"># &#x6d4b;&#x8bd5;&#x73af;&#x5883;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">InMemoryUserRepository</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x5185;&#x5b58;&#x7528;&#x6237;&#x4ed3;&#x50a8;&#xff08;&#x6d4b;&#x8bd5;&#x7528;&#xff09;&quot;&quot;&quot;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>._users: <span class=\"hljs-built_in\">dict</span>[<span class=\"hljs-built_in\">str</span>, User] = {}\n    \n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">find_by_id</span>(<span class=\"hljs-params\">self, user_id: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-type\">Optional</span>[User]:\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">self</span>._users.get(user_id)\n    \n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">save</span>(<span class=\"hljs-params\">self, user: User</span>) -&gt; <span class=\"hljs-literal\">None</span>:\n        <span class=\"hljs-variable language_\">self</span>._users[user.<span class=\"hljs-built_in\">id</span>] = user\n\ntest_repo = InMemoryUserRepository()\ntest_service = UserService(test_repo)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"739,822"}},{"content":"<pre data-lines=\"824,841\"><code class=\"language-python\"><span class=\"hljs-comment\"># TaskQueue &#x5c31;&#x662f;&#x4e00;&#x4e2a;&#x4efb;&#x52a1;&#x4ed3;&#x50a8;&#xff01;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TaskQueue</span>(<span class=\"hljs-title class_ inherited__\">Protocol</span>):  <span class=\"hljs-comment\"># &#x4ed3;&#x50a8;&#x63a5;&#x53e3;</span>\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">add_task</span>(<span class=\"hljs-params\">self, task: Task</span>) -&gt; <span class=\"hljs-literal\">None</span>: ...  <span class=\"hljs-comment\"># save</span>\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_task</span>(<span class=\"hljs-params\">self, task_id: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-type\">Optional</span>[Task]: ...  <span class=\"hljs-comment\"># find_by_id</span>\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_pending_tasks</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">list</span>[Task]: ...  <span class=\"hljs-comment\"># find_all (with filter)</span>\n\n<span class=\"hljs-comment\"># &#x4e0d;&#x540c;&#x7684;&#x5b9e;&#x73b0;&#xff08;&#x5b58;&#x50a8;&#x540e;&#x7aef;&#xff09;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SQLiteTaskQueue</span>: ...  <span class=\"hljs-comment\"># SQLite &#x4ed3;&#x50a8;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">RedisTaskQueue</span>: ...   <span class=\"hljs-comment\"># Redis &#x4ed3;&#x50a8;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">InMemoryTaskQueue</span>: ...  <span class=\"hljs-comment\"># &#x5185;&#x5b58;&#x4ed3;&#x50a8;</span>\n\n<span class=\"hljs-comment\"># &#x4e1a;&#x52a1;&#x5c42;&#xff08;Worker&#xff09;&#x53ea;&#x4f9d;&#x8d56;&#x63a5;&#x53e3;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TaskWorker</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, queue: TaskQueue</span>):  <span class=\"hljs-comment\"># &#x4f9d;&#x8d56;&#x4ed3;&#x50a8;&#x63a5;&#x53e3;</span>\n        <span class=\"hljs-variable language_\">self</span>.queue = queue\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"824,841"}}],"payload":{"tag":"h3","lines":"702,703"}}],"payload":{"tag":"h2","lines":"220,221"}},{"content":"<strong>3. &#x884c;&#x4e3a;&#x578b;&#x6a21;&#x5f0f;</strong>","children":[{"content":"<svg width=\"16\" height=\"16\" viewBox=\"0 -3 24 24\"><path d=\"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z\"/></svg> <strong>&#x7b56;&#x7565;&#x6a21;&#x5f0f;&#xff08;Strategy Pattern&#xff09;</strong>","children":[{"content":"<pre data-lines=\"874,914\"><code class=\"language-python\"><span class=\"hljs-keyword\">from</span> typing <span class=\"hljs-keyword\">import</span> Protocol\n\n<span class=\"hljs-comment\"># 1. &#x7b56;&#x7565;&#x534f;&#x8bae;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DataProcessor</span>(<span class=\"hljs-title class_ inherited__\">Protocol</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process</span>(<span class=\"hljs-params\">self, data: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-built_in\">str</span>: ...\n\n<span class=\"hljs-comment\"># 2. &#x5177;&#x4f53;&#x7b56;&#x7565;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">UpperCaseProcessor</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process</span>(<span class=\"hljs-params\">self, data: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-keyword\">return</span> data.upper()\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">LowerCaseProcessor</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process</span>(<span class=\"hljs-params\">self, data: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-keyword\">return</span> data.lower()\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ReverseProcessor</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process</span>(<span class=\"hljs-params\">self, data: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-keyword\">return</span> data[::-<span class=\"hljs-number\">1</span>]\n\n<span class=\"hljs-comment\"># 3. &#x4e0a;&#x4e0b;&#x6587;&#x7c7b;&#xff1a;&#x4f7f;&#x7528;&#x7b56;&#x7565;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TextEditor</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, processor: DataProcessor</span>):\n        <span class=\"hljs-variable language_\">self</span>.processor = processor\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">set_processor</span>(<span class=\"hljs-params\">self, processor: DataProcessor</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x8fd0;&#x884c;&#x65f6;&#x5207;&#x6362;&#x7b56;&#x7565;&quot;&quot;&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>.processor = processor\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">transform</span>(<span class=\"hljs-params\">self, text: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">self</span>.processor.process(text)\n\n<span class=\"hljs-comment\"># &#x4f7f;&#x7528;</span>\ntext = <span class=\"hljs-string\">&quot;Hello World&quot;</span>\neditor = TextEditor(UpperCaseProcessor())\n<span class=\"hljs-built_in\">print</span>(editor.transform(text))  <span class=\"hljs-comment\"># HELLO WORLD</span>\n\neditor.set_processor(LowerCaseProcessor())\n<span class=\"hljs-built_in\">print</span>(editor.transform(text))  <span class=\"hljs-comment\"># hello world</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"874,914"}}],"payload":{"tag":"h3","lines":"846,847"}},{"content":"<svg width=\"16\" height=\"16\" viewBox=\"0 -3 24 24\"><path d=\"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z\"/></svg> <strong>&#x89c2;&#x5bdf;&#x8005;&#x6a21;&#x5f0f;&#xff08;Observer Pattern&#xff09;</strong>","children":[{"content":"<pre data-lines=\"944,1007\"><code class=\"language-python\"><span class=\"hljs-keyword\">from</span> typing <span class=\"hljs-keyword\">import</span> Protocol\n<span class=\"hljs-keyword\">from</span> enum <span class=\"hljs-keyword\">import</span> Enum\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TaskStatus</span>(<span class=\"hljs-title class_ inherited__\">Enum</span>):\n    PENDING = <span class=\"hljs-string\">&quot;pending&quot;</span>\n    RUNNING = <span class=\"hljs-string\">&quot;running&quot;</span>\n    COMPLETED = <span class=\"hljs-string\">&quot;completed&quot;</span>\n\n<span class=\"hljs-comment\"># 1. &#x89c2;&#x5bdf;&#x8005;&#x534f;&#x8bae;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TaskObserver</span>(<span class=\"hljs-title class_ inherited__\">Protocol</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">on_status_change</span>(<span class=\"hljs-params\">\n        self, task_id: <span class=\"hljs-built_in\">str</span>, \n        old_status: TaskStatus, \n        new_status: TaskStatus\n    </span>) -&gt; <span class=\"hljs-literal\">None</span>: ...\n\n<span class=\"hljs-comment\"># 2. &#x88ab;&#x89c2;&#x5bdf;&#x8005;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Task</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, task_id: <span class=\"hljs-built_in\">str</span></span>):\n        <span class=\"hljs-variable language_\">self</span>.task_id = task_id\n        <span class=\"hljs-variable language_\">self</span>._status = TaskStatus.PENDING\n        <span class=\"hljs-variable language_\">self</span>._observers: <span class=\"hljs-built_in\">list</span>[TaskObserver] = []\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">attach</span>(<span class=\"hljs-params\">self, observer: TaskObserver</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x6dfb;&#x52a0;&#x89c2;&#x5bdf;&#x8005;&quot;&quot;&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>._observers.append(observer)\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">notify</span>(<span class=\"hljs-params\">self, old_status: TaskStatus, new_status: TaskStatus</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x901a;&#x77e5;&#x6240;&#x6709;&#x89c2;&#x5bdf;&#x8005;&quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">for</span> observer <span class=\"hljs-keyword\">in</span> <span class=\"hljs-variable language_\">self</span>._observers:\n            observer.on_status_change(<span class=\"hljs-variable language_\">self</span>.task_id, old_status, new_status)\n    \n<span class=\"hljs-meta\">    @property</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">status</span>(<span class=\"hljs-params\">self</span>) -&gt; TaskStatus:\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">self</span>._status\n    \n<span class=\"hljs-meta\">    @status.setter</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">status</span>(<span class=\"hljs-params\">self, new_status: TaskStatus</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x72b6;&#x6001;&#x6539;&#x53d8;&#x65f6;&#x81ea;&#x52a8;&#x901a;&#x77e5;&quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">if</span> new_status != <span class=\"hljs-variable language_\">self</span>._status:\n            old_status = <span class=\"hljs-variable language_\">self</span>._status\n            <span class=\"hljs-variable language_\">self</span>._status = new_status\n            <span class=\"hljs-variable language_\">self</span>.notify(old_status, new_status)\n\n<span class=\"hljs-comment\"># 3. &#x5177;&#x4f53;&#x89c2;&#x5bdf;&#x8005;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">LoggerObserver</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">on_status_change</span>(<span class=\"hljs-params\">self, task_id: <span class=\"hljs-built_in\">str</span>, old: TaskStatus, new: TaskStatus</span>):\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;[&#x65e5;&#x5fd7;] <span class=\"hljs-subst\">{task_id}</span>: <span class=\"hljs-subst\">{old.value}</span> -&gt; <span class=\"hljs-subst\">{new.value}</span>&quot;</span>)\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">EmailObserver</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">on_status_change</span>(<span class=\"hljs-params\">self, task_id: <span class=\"hljs-built_in\">str</span>, old: TaskStatus, new: TaskStatus</span>):\n        <span class=\"hljs-keyword\">if</span> new == TaskStatus.COMPLETED:\n            <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;[&#x90ae;&#x4ef6;] &#x4efb;&#x52a1; <span class=\"hljs-subst\">{task_id}</span> &#x5df2;&#x5b8c;&#x6210;&quot;</span>)\n\n<span class=\"hljs-comment\"># &#x4f7f;&#x7528;</span>\ntask = Task(<span class=\"hljs-string\">&quot;task-001&quot;</span>)\ntask.attach(LoggerObserver())\ntask.attach(EmailObserver())\n\ntask.status = TaskStatus.RUNNING   <span class=\"hljs-comment\"># &#x81ea;&#x52a8;&#x901a;&#x77e5;</span>\ntask.status = TaskStatus.COMPLETED  <span class=\"hljs-comment\"># &#x81ea;&#x52a8;&#x901a;&#x77e5;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"944,1007"}}],"payload":{"tag":"h3","lines":"917,918"}},{"content":"<svg width=\"16\" height=\"16\" viewBox=\"0 -3 24 24\"><path d=\"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z\"/></svg> <strong>&#x88c5;&#x9970;&#x5668;&#x6a21;&#x5f0f;&#xff08;Decorator Pattern&#xff09;</strong>","children":[{"content":"<pre data-lines=\"1042,1097\"><code class=\"language-python\"><span class=\"hljs-keyword\">from</span> functools <span class=\"hljs-keyword\">import</span> wraps\n<span class=\"hljs-keyword\">import</span> time\n\n<span class=\"hljs-comment\"># 1. &#x51fd;&#x6570;&#x88c5;&#x9970;&#x5668;</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">timer</span>(<span class=\"hljs-params\">func</span>):\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x8ba1;&#x65f6;&#x88c5;&#x9970;&#x5668;&quot;&quot;&quot;</span>\n<span class=\"hljs-meta\">    @wraps(<span class=\"hljs-params\">func</span>)</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">wrapper</span>(<span class=\"hljs-params\">*args, **kwargs</span>):\n        start = time.time()\n        result = func(*args, **kwargs)\n        end = time.time()\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{func.__name__}</span> &#x8017;&#x65f6;: <span class=\"hljs-subst\">{end - start:<span class=\"hljs-number\">.3</span>f}</span>&#x79d2;&quot;</span>)\n        <span class=\"hljs-keyword\">return</span> result\n    <span class=\"hljs-keyword\">return</span> wrapper\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">logger</span>(<span class=\"hljs-params\">func</span>):\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x65e5;&#x5fd7;&#x88c5;&#x9970;&#x5668;&quot;&quot;&quot;</span>\n<span class=\"hljs-meta\">    @wraps(<span class=\"hljs-params\">func</span>)</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">wrapper</span>(<span class=\"hljs-params\">*args, **kwargs</span>):\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;&#x8c03;&#x7528; <span class=\"hljs-subst\">{func.__name__}</span>&#xff0c;&#x53c2;&#x6570;: <span class=\"hljs-subst\">{args}</span>, <span class=\"hljs-subst\">{kwargs}</span>&quot;</span>)\n        result = func(*args, **kwargs)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{func.__name__}</span> &#x8fd4;&#x56de;: <span class=\"hljs-subst\">{result}</span>&quot;</span>)\n        <span class=\"hljs-keyword\">return</span> result\n    <span class=\"hljs-keyword\">return</span> wrapper\n\n<span class=\"hljs-comment\"># 2. &#x53e0;&#x52a0;&#x4f7f;&#x7528;&#xff08;&#x4ece;&#x4e0b;&#x5f80;&#x4e0a;&#x5e94;&#x7528;&#xff09;</span>\n<span class=\"hljs-meta\">@timer</span>\n<span class=\"hljs-meta\">@logger</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">calculate</span>(<span class=\"hljs-params\">x: <span class=\"hljs-built_in\">int</span>, y: <span class=\"hljs-built_in\">int</span></span>) -&gt; <span class=\"hljs-built_in\">int</span>:\n    time.sleep(<span class=\"hljs-number\">1</span>)\n    <span class=\"hljs-keyword\">return</span> x + y\n\n<span class=\"hljs-comment\"># 3. &#x7c7b;&#x88c5;&#x9970;&#x5668;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">RetryDecorator</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, max_retries: <span class=\"hljs-built_in\">int</span> = <span class=\"hljs-number\">3</span></span>):\n        <span class=\"hljs-variable language_\">self</span>.max_retries = max_retries\n    \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__call__</span>(<span class=\"hljs-params\">self, func</span>):\n<span class=\"hljs-meta\">        @wraps(<span class=\"hljs-params\">func</span>)</span>\n        <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">wrapper</span>(<span class=\"hljs-params\">*args, **kwargs</span>):\n            <span class=\"hljs-keyword\">for</span> attempt <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-variable language_\">self</span>.max_retries):\n                <span class=\"hljs-keyword\">try</span>:\n                    <span class=\"hljs-keyword\">return</span> func(*args, **kwargs)\n                <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n                    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;&#x7b2c; <span class=\"hljs-subst\">{attempt + <span class=\"hljs-number\">1</span>}</span> &#x6b21;&#x5c1d;&#x8bd5;&#x5931;&#x8d25;: <span class=\"hljs-subst\">{e}</span>&quot;</span>)\n                    <span class=\"hljs-keyword\">if</span> attempt == <span class=\"hljs-variable language_\">self</span>.max_retries - <span class=\"hljs-number\">1</span>:\n                        <span class=\"hljs-keyword\">raise</span>\n        <span class=\"hljs-keyword\">return</span> wrapper\n\n<span class=\"hljs-meta\">@RetryDecorator(<span class=\"hljs-params\">max_retries=<span class=\"hljs-number\">3</span></span>)</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">unstable_function</span>():\n    <span class=\"hljs-comment\"># &#x4e0d;&#x7a33;&#x5b9a;&#x7684;&#x51fd;&#x6570;</span>\n    <span class=\"hljs-keyword\">pass</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1042,1097"}}],"payload":{"tag":"h3","lines":"1010,1011"}}],"payload":{"tag":"h2","lines":"844,845"}},{"content":"<strong>4. &#x8bbe;&#x8ba1;&#x6a21;&#x5f0f;&#x603b;&#x7ed3;&#x5bf9;&#x6bd4;</strong>","children":[{"content":"<table data-lines=\"1102,1116\">\n<thead data-lines=\"1102,1103\">\n<tr data-lines=\"1102,1103\">\n<th>&#x6a21;&#x5f0f;</th>\n<th>&#x7c7b;&#x522b;</th>\n<th>&#x6838;&#x5fc3;&#x76ee;&#x7684;</th>\n<th>&#x4e3b;&#x8981;&#x4f18;&#x52bf;</th>\n<th>&#x5178;&#x578b;&#x573a;&#x666f;</th>\n</tr>\n</thead>\n<tbody data-lines=\"1104,1116\">\n<tr data-lines=\"1104,1105\">\n<td><strong>&#x5de5;&#x5382;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x521b;&#x5efa;&#x578b;</td>\n<td>&#x89e3;&#x8026;&#x5bf9;&#x8c61;&#x521b;&#x5efa;</td>\n<td>&#x914d;&#x7f6e;&#x9a71;&#x52a8;&#x3001;&#x6613;&#x6269;&#x5c55;</td>\n<td>&#x591a;&#x79cd;&#x6570;&#x636e;&#x5e93;/&#x961f;&#x5217;&#x9009;&#x62e9;</td>\n</tr>\n<tr data-lines=\"1105,1106\">\n<td><strong>&#x5355;&#x4f8b;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x521b;&#x5efa;&#x578b;</td>\n<td>&#x5168;&#x5c40;&#x552f;&#x4e00;&#x5b9e;&#x4f8b;</td>\n<td>&#x8282;&#x7701;&#x8d44;&#x6e90;&#x3001;&#x72b6;&#x6001;&#x5171;&#x4eab;</td>\n<td>&#x914d;&#x7f6e;&#x7ba1;&#x7406;&#x5668;&#x3001;&#x8fde;&#x63a5;&#x6c60;</td>\n</tr>\n<tr data-lines=\"1106,1107\">\n<td><strong>&#x5efa;&#x9020;&#x8005;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x521b;&#x5efa;&#x578b;</td>\n<td>&#x5206;&#x6b65;&#x6784;&#x5efa;&#x5bf9;&#x8c61;</td>\n<td>&#x94fe;&#x5f0f;&#x8c03;&#x7528;&#x3001;&#x6e05;&#x6670;&#x6613;&#x8bfb;</td>\n<td>SQL &#x67e5;&#x8be2;&#x3001;HTTP &#x8bf7;&#x6c42;</td>\n</tr>\n<tr data-lines=\"1107,1108\">\n<td><strong>Mixin</strong></td>\n<td>&#x7ed3;&#x6784;&#x578b;</td>\n<td>&#x529f;&#x80fd;&#x6df7;&#x5165;</td>\n<td>&#x4ee3;&#x7801;&#x590d;&#x7528;&#x3001;&#x7075;&#x6d3b;&#x7ec4;&#x5408;</td>\n<td>&#x65f6;&#x95f4;&#x6233;&#x3001;&#x5e8f;&#x5217;&#x5316;</td>\n</tr>\n<tr data-lines=\"1108,1109\">\n<td><strong>&#x534f;&#x8bae;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x7ed3;&#x6784;&#x578b;</td>\n<td>&#x5b9a;&#x4e49;&#x63a5;&#x53e3;&#x89c4;&#x8303;</td>\n<td>&#x9e2d;&#x5b50;&#x7c7b;&#x578b;&#x3001;&#x7c7b;&#x578b;&#x68c0;&#x67e5;</td>\n<td>&#x4efb;&#x52a1;&#x961f;&#x5217;&#x3001;&#x6570;&#x636e;&#x5904;&#x7406;</td>\n</tr>\n<tr data-lines=\"1109,1110\">\n<td><strong>&#x9002;&#x914d;&#x5668;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x7ed3;&#x6784;&#x578b;</td>\n<td>&#x63a5;&#x53e3;&#x8f6c;&#x6362;</td>\n<td>&#x7edf;&#x4e00;&#x63a5;&#x53e3;&#x3001;&#x517c;&#x5bb9;&#x65e7;&#x4ee3;&#x7801;</td>\n<td>&#x7b2c;&#x4e09;&#x65b9;&#x5e93;&#x96c6;&#x6210;</td>\n</tr>\n<tr data-lines=\"1110,1111\">\n<td><strong>&#x5916;&#x89c2;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x7ed3;&#x6784;&#x578b;</td>\n<td>&#x7b80;&#x5316;&#x590d;&#x6742;&#x63a5;&#x53e3;</td>\n<td>&#x9690;&#x85cf;&#x7ec6;&#x8282;&#x3001;&#x6613;&#x7528;&#x6027;</td>\n<td>&#x89c6;&#x9891;&#x8f6c;&#x6362;&#x3001;&#x8ba2;&#x5355;&#x5904;&#x7406;</td>\n</tr>\n<tr data-lines=\"1111,1112\">\n<td><strong>&#x4f9d;&#x8d56;&#x6ce8;&#x5165;</strong> &#x2b50;</td>\n<td>&#x7ed3;&#x6784;&#x578b;</td>\n<td>&#x89e3;&#x8026;&#x4f9d;&#x8d56;&#x5173;&#x7cfb;</td>\n<td>&#x53ef;&#x6d4b;&#x8bd5;&#x3001;&#x53ef;&#x66ff;&#x6362;</td>\n<td>&#x670d;&#x52a1;&#x5c42;&#x3001;&#x6d4b;&#x8bd5; mock</td>\n</tr>\n<tr data-lines=\"1112,1113\">\n<td><strong>&#x4ed3;&#x50a8;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x7ed3;&#x6784;&#x578b;</td>\n<td>&#x62bd;&#x8c61;&#x6570;&#x636e;&#x8bbf;&#x95ee;</td>\n<td>&#x9694;&#x79bb;&#x5b58;&#x50a8;&#x3001;&#x6613;&#x5207;&#x6362;</td>\n<td>&#x7528;&#x6237;/&#x8ba2;&#x5355;/&#x4efb;&#x52a1;&#x6570;&#x636e;&#x8bbf;&#x95ee;</td>\n</tr>\n<tr data-lines=\"1113,1114\">\n<td><strong>&#x7b56;&#x7565;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x884c;&#x4e3a;&#x578b;</td>\n<td>&#x7b97;&#x6cd5;&#x53ef;&#x66ff;&#x6362;</td>\n<td>&#x907f;&#x514d; if-else&#x3001;&#x6613;&#x6269;&#x5c55;</td>\n<td>&#x652f;&#x4ed8;&#x65b9;&#x5f0f;&#x3001;&#x6392;&#x5e8f;&#x7b97;&#x6cd5;</td>\n</tr>\n<tr data-lines=\"1114,1115\">\n<td><strong>&#x89c2;&#x5bdf;&#x8005;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x884c;&#x4e3a;&#x578b;</td>\n<td>&#x72b6;&#x6001;&#x53d8;&#x5316;&#x901a;&#x77e5;</td>\n<td>&#x89e3;&#x8026;&#x3001;&#x4e8b;&#x4ef6;&#x9a71;&#x52a8;</td>\n<td>&#x4efb;&#x52a1;&#x76d1;&#x542c;&#x3001;UI &#x4e8b;&#x4ef6;</td>\n</tr>\n<tr data-lines=\"1115,1116\">\n<td><strong>&#x88c5;&#x9970;&#x5668;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x884c;&#x4e3a;&#x578b;</td>\n<td>&#x52a8;&#x6001;&#x6dfb;&#x52a0;&#x529f;&#x80fd;</td>\n<td>&#x4e0d;&#x4fee;&#x6539;&#x539f;&#x4ee3;&#x7801;&#x3001;&#x53ef;&#x53e0;&#x52a0;</td>\n<td>&#x65e5;&#x5fd7;&#x3001;&#x8ba1;&#x65f6;&#x3001;&#x7f13;&#x5b58;</td>\n</tr>\n</tbody>\n</table>","children":[],"payload":{"tag":"table","lines":"1102,1116"}}],"payload":{"tag":"h2","lines":"1100,1101"}},{"content":"<strong>5. &#x5728;&#x5b9e;&#x9645;&#x9879;&#x76ee;&#x4e2d;&#x7684;&#x5e94;&#x7528;</strong>","children":[{"content":"<strong>queue &#x9879;&#x76ee;&#x4e2d;&#x5df2;&#x4f7f;&#x7528;&#x7684;&#x6a21;&#x5f0f;</strong>","children":[{"content":"&#x2705; <strong>&#x5de5;&#x5382;&#x6a21;&#x5f0f;</strong> - <code>QueueFactory</code>","children":[{"content":"<pre data-lines=\"1126,1130\"><code class=\"language-python\"><span class=\"hljs-comment\"># factory.py</span>\nqueue = QueueFactory.create(<span class=\"hljs-string\">&quot;sqlite&quot;</span>, db_path=<span class=\"hljs-string\">&quot;prod.db&quot;</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1126,1130"}}],"payload":{"tag":"h4","lines":"1125,1126"}},{"content":"&#x2705; <strong>&#x534f;&#x8bae;&#x6a21;&#x5f0f;</strong> - <code>TaskQueue Protocol</code>","children":[{"content":"<pre data-lines=\"1132,1137\"><code class=\"language-python\"><span class=\"hljs-comment\"># protocol.py</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TaskQueue</span>(<span class=\"hljs-title class_ inherited__\">Protocol</span>):\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">add_task</span>(<span class=\"hljs-params\">self, task: Task</span>) -&gt; <span class=\"hljs-literal\">None</span>: ...\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1132,1137"}}],"payload":{"tag":"h4","lines":"1131,1132"}},{"content":"&#x2705; <strong>Mixin &#x6a21;&#x5f0f;</strong> - <code>TimestampMixin</code>","children":[{"content":"<pre data-lines=\"1139,1145\"><code class=\"language-python\"><span class=\"hljs-comment\"># models.py</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Task</span>(<span class=\"hljs-title class_ inherited__\">TimestampMixin</span>):\n    <span class=\"hljs-comment\"># &#x81ea;&#x52a8;&#x83b7;&#x5f97; created_at&#x3001;updated_at</span>\n    <span class=\"hljs-keyword\">pass</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1139,1145"}}],"payload":{"tag":"h4","lines":"1138,1139"}},{"content":"&#x2705; <strong>&#x4f9d;&#x8d56;&#x6ce8;&#x5165;</strong> - <code>TaskWorker</code>","children":[{"content":"<pre data-lines=\"1147,1153\"><code class=\"language-python\"><span class=\"hljs-comment\"># worker.py</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TaskWorker</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, queue: TaskQueue</span>):  <span class=\"hljs-comment\"># &#x1f525; &#x4f9d;&#x8d56;&#x6ce8;&#x5165;</span>\n        <span class=\"hljs-variable language_\">self</span>.queue = queue  <span class=\"hljs-comment\"># &#x4ece;&#x5916;&#x90e8;&#x4f20;&#x5165;&#xff0c;&#x4e0d;&#x5728;&#x5185;&#x90e8;&#x521b;&#x5efa;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1147,1153"}}],"payload":{"tag":"h4","lines":"1146,1147"}},{"content":"&#x2705; <strong>&#x4ed3;&#x50a8;&#x6a21;&#x5f0f;</strong> - <code>TaskQueue</code> &#x672c;&#x8d28;&#x4e0a;&#x662f;&#x4efb;&#x52a1;&#x4ed3;&#x50a8;","children":[{"content":"<pre data-lines=\"1155,1161\"><code class=\"language-python\"><span class=\"hljs-comment\"># TaskQueue &#x63d0;&#x4f9b;&#x7c7b;&#x4f3c;&#x96c6;&#x5408;&#x7684;&#x63a5;&#x53e3;&#x64cd;&#x4f5c;&#x4efb;&#x52a1;</span>\n<span class=\"hljs-comment\"># - add_task() &#x2192; save()</span>\n<span class=\"hljs-comment\"># - get_task() &#x2192; find_by_id()</span>\n<span class=\"hljs-comment\"># - get_pending_tasks() &#x2192; find_all(filter)</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1155,1161"}}],"payload":{"tag":"h4","lines":"1154,1155"}}],"payload":{"tag":"h3","lines":"1123,1124"}},{"content":"<strong>&#x53ef;&#x4ee5;&#x6dfb;&#x52a0;&#x7684;&#x6a21;&#x5f0f;</strong>","children":[{"content":"&#x5efa;&#x8bae; 1&#xff1a;<strong>&#x89c2;&#x5bdf;&#x8005;&#x6a21;&#x5f0f;</strong> - &#x4efb;&#x52a1;&#x72b6;&#x6001;&#x76d1;&#x542c;","children":[{"content":"<pre data-lines=\"1165,1172\"><code class=\"language-python\"><span class=\"hljs-comment\"># &#x76d1;&#x542c;&#x4efb;&#x52a1;&#x5b8c;&#x6210;&#xff0c;&#x53d1;&#x9001;&#x901a;&#x77e5;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TaskCompletionObserver</span>:\n    <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">on_task_completed</span>(<span class=\"hljs-params\">self, task_id: <span class=\"hljs-built_in\">str</span>, result: <span class=\"hljs-built_in\">str</span></span>):\n        <span class=\"hljs-comment\"># &#x53d1;&#x9001;&#x90ae;&#x4ef6;&#x3001;webhook &#x7b49;</span>\n        <span class=\"hljs-keyword\">pass</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1165,1172"}}],"payload":{"tag":"h4","lines":"1164,1165"}},{"content":"&#x5efa;&#x8bae; 2&#xff1a;<strong>&#x7b56;&#x7565;&#x6a21;&#x5f0f;</strong> - &#x4efb;&#x52a1;&#x91cd;&#x8bd5;&#x7b56;&#x7565;","children":[{"content":"<pre data-lines=\"1174,1187\"><code class=\"language-python\"><span class=\"hljs-comment\"># &#x4e0d;&#x540c;&#x7684;&#x91cd;&#x8bd5;&#x7b56;&#x7565;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">RetryStrategy</span>(<span class=\"hljs-title class_ inherited__\">Protocol</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_delay</span>(<span class=\"hljs-params\">self, attempt: <span class=\"hljs-built_in\">int</span></span>) -&gt; <span class=\"hljs-built_in\">float</span>: ...\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">FixedRetryStrategy</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_delay</span>(<span class=\"hljs-params\">self, attempt: <span class=\"hljs-built_in\">int</span></span>) -&gt; <span class=\"hljs-built_in\">float</span>:\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">5.0</span>  <span class=\"hljs-comment\"># &#x56fa;&#x5b9a; 5 &#x79d2;</span>\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ExponentialRetryStrategy</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_delay</span>(<span class=\"hljs-params\">self, attempt: <span class=\"hljs-built_in\">int</span></span>) -&gt; <span class=\"hljs-built_in\">float</span>:\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">2</span> ** attempt  <span class=\"hljs-comment\"># &#x6307;&#x6570;&#x9000;&#x907f;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1174,1187"}}],"payload":{"tag":"h4","lines":"1173,1174"}},{"content":"&#x5efa;&#x8bae; 3&#xff1a;<strong>&#x88c5;&#x9970;&#x5668;&#x6a21;&#x5f0f;</strong> - &#x4efb;&#x52a1;&#x8ba1;&#x65f6;","children":[{"content":"<pre data-lines=\"1189,1196\"><code class=\"language-python\"><span class=\"hljs-meta\">@timer</span>\n<span class=\"hljs-meta\">@retry(<span class=\"hljs-params\">max_attempts=<span class=\"hljs-number\">3</span></span>)</span>\n<span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_task</span>(<span class=\"hljs-params\">task: Task</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n    <span class=\"hljs-comment\"># &#x81ea;&#x52a8;&#x8ba1;&#x65f6;&#x3001;&#x81ea;&#x52a8;&#x91cd;&#x8bd5;</span>\n    <span class=\"hljs-keyword\">pass</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1189,1196"}}],"payload":{"tag":"h4","lines":"1188,1189"}}],"payload":{"tag":"h3","lines":"1162,1163"}}],"payload":{"tag":"h2","lines":"1121,1122"}},{"content":"<strong>6. &#x8bbe;&#x8ba1;&#x6a21;&#x5f0f;&#x7684;&#x9009;&#x62e9;&#x539f;&#x5219;</strong>","children":[{"content":"<strong>&#x4f55;&#x65f6;&#x4f7f;&#x7528;&#xff1f;</strong>","children":[{"content":"1. <strong>&#x5de5;&#x5382;&#x6a21;&#x5f0f;</strong>&#xff1a;&#x9700;&#x8981;&#x6839;&#x636e;&#x914d;&#x7f6e;/&#x53c2;&#x6570;&#x521b;&#x5efa;&#x4e0d;&#x540c;&#x7c7b;&#x578b;&#x7684;&#x5bf9;&#x8c61;","children":[],"payload":{"tag":"li","lines":"1204,1205","listIndex":1}},{"content":"2. <strong>&#x5355;&#x4f8b;&#x6a21;&#x5f0f;</strong>&#xff1a;&#x9700;&#x8981;&#x5168;&#x5c40;&#x552f;&#x4e00;&#x7684;&#x8d44;&#x6e90;&#xff08;&#x8c28;&#x614e;&#x4f7f;&#x7528;&#xff0c;&#x53ef;&#x80fd;&#x5bfc;&#x81f4;&#x6d4b;&#x8bd5;&#x56f0;&#x96be;&#xff09;","children":[],"payload":{"tag":"li","lines":"1205,1206","listIndex":2}},{"content":"3. <strong>&#x5efa;&#x9020;&#x8005;&#x6a21;&#x5f0f;</strong>&#xff1a;&#x6784;&#x9020;&#x51fd;&#x6570;&#x53c2;&#x6570;&#x8d85;&#x8fc7; 5 &#x4e2a;&#xff0c;&#x6216;&#x6784;&#x5efa;&#x8fc7;&#x7a0b;&#x590d;&#x6742;","children":[],"payload":{"tag":"li","lines":"1206,1208","listIndex":3}}],"payload":{"tag":"h3","lines":"1201,1202"}},{"content":"<strong>&#x4e0d;&#x8981;&#x8fc7;&#x5ea6;&#x8bbe;&#x8ba1;</strong>","children":[{"content":"<strong>YAGNI &#x539f;&#x5219;</strong>&#xff1a;You Aren&apos;t Gonna Need It&#xff08;&#x4f60;&#x4e0d;&#x4f1a;&#x9700;&#x8981;&#x5b83;&#xff09;","children":[],"payload":{"tag":"li","lines":"1223,1224"}},{"content":"<strong>&#x5148;&#x7b80;&#x5355;&#x5b9e;&#x73b0;</strong>&#xff0c;&#x6709;&#x9700;&#x6c42;&#x518d;&#x91cd;&#x6784;","children":[],"payload":{"tag":"li","lines":"1224,1225"}},{"content":"<strong>&#x8bbe;&#x8ba1;&#x6a21;&#x5f0f;&#x662f;&#x5de5;&#x5177;</strong>&#xff0c;&#x4e0d;&#x662f;&#x76ee;&#x7684;","children":[],"payload":{"tag":"li","lines":"1225,1226"}},{"content":"<strong>&#x4ee3;&#x7801;&#x53ef;&#x8bfb;&#x6027;&#x4f18;&#x5148;</strong>","children":[],"payload":{"tag":"li","lines":"1226,1228"}}],"payload":{"tag":"h3","lines":"1221,1222"}}],"payload":{"tag":"h2","lines":"1199,1200"}},{"content":"<strong>7. Python &#x8bbe;&#x8ba1;&#x6a21;&#x5f0f;&#x7684;&#x7279;&#x70b9;</strong>","children":[{"content":"<strong>Python &#x7684;&#x4f18;&#x52bf;</strong>","children":[{"content":"1. <strong>&#x9e2d;&#x5b50;&#x7c7b;&#x578b;</strong>&#xff1a;Protocol &#x8ba9;&#x63a5;&#x53e3;&#x66f4;&#x7075;&#x6d3b;","children":[],"payload":{"tag":"li","lines":"1234,1235","listIndex":1}},{"content":"2. <strong>&#x4e00;&#x7b49;&#x51fd;&#x6570;</strong>&#xff1a;&#x7b56;&#x7565;&#x53ef;&#x4ee5;&#x662f;&#x51fd;&#x6570;&#xff0c;&#x4e0d;&#x4e00;&#x5b9a;&#x8981;&#x7c7b;","children":[],"payload":{"tag":"li","lines":"1235,1236","listIndex":2}},{"content":"3. <strong>&#x88c5;&#x9970;&#x5668;&#x8bed;&#x6cd5;</strong>&#xff1a;&#x539f;&#x751f;&#x652f;&#x6301;&#x88c5;&#x9970;&#x5668;&#x6a21;&#x5f0f;","children":[],"payload":{"tag":"li","lines":"1236,1237","listIndex":3}},{"content":"4. <strong>&#x591a;&#x91cd;&#x7ee7;&#x627f;</strong>&#xff1a;Mixin &#x6a21;&#x5f0f;&#x66f4;&#x81ea;&#x7136;","children":[],"payload":{"tag":"li","lines":"1237,1238","listIndex":4}},{"content":"5. <strong>&#x52a8;&#x6001;&#x7c7b;&#x578b;</strong>&#xff1a;&#x5de5;&#x5382;&#x6a21;&#x5f0f;&#x66f4;&#x7b80;&#x6d01;","children":[],"payload":{"tag":"li","lines":"1238,1240","listIndex":5}}],"payload":{"tag":"h3","lines":"1232,1233"}},{"content":"<strong>&#x4e0e;&#x9759;&#x6001;&#x8bed;&#x8a00;&#x7684;&#x533a;&#x522b;</strong>","children":[{"content":"<table data-lines=\"1242,1248\">\n<thead data-lines=\"1242,1243\">\n<tr data-lines=\"1242,1243\">\n<th>&#x7279;&#x6027;</th>\n<th>Python</th>\n<th>Java/C++</th>\n</tr>\n</thead>\n<tbody data-lines=\"1244,1248\">\n<tr data-lines=\"1244,1245\">\n<td>&#x63a5;&#x53e3;&#x5b9a;&#x4e49;</td>\n<td>Protocol&#xff08;&#x7ed3;&#x6784;&#x5316;&#x7c7b;&#x578b;&#xff09;</td>\n<td>Interface/Abstract Class&#xff08;&#x540d;&#x4e49;&#x7c7b;&#x578b;&#xff09;</td>\n</tr>\n<tr data-lines=\"1245,1246\">\n<td>&#x88c5;&#x9970;&#x5668;</td>\n<td>&#x8bed;&#x6cd5;&#x7cd6; <code>@decorator</code></td>\n<td>&#x9700;&#x8981;&#x624b;&#x52a8;&#x5b9e;&#x73b0;&#x5305;&#x88c5;&#x7c7b;</td>\n</tr>\n<tr data-lines=\"1246,1247\">\n<td>&#x5355;&#x4f8b;</td>\n<td>&#x88c5;&#x9970;&#x5668;/&#x5143;&#x7c7b;</td>\n<td>&#x79c1;&#x6709;&#x6784;&#x9020;&#x51fd;&#x6570; + &#x9759;&#x6001;&#x65b9;&#x6cd5;</td>\n</tr>\n<tr data-lines=\"1247,1248\">\n<td>&#x7b56;&#x7565;</td>\n<td>&#x53ef;&#x4ee5;&#x7528;&#x51fd;&#x6570;</td>\n<td>&#x901a;&#x5e38;&#x9700;&#x8981;&#x7c7b;</td>\n</tr>\n</tbody>\n</table>","children":[],"payload":{"tag":"table","lines":"1242,1248"}}],"payload":{"tag":"h3","lines":"1240,1241"}}],"payload":{"tag":"h2","lines":"1230,1231"}},{"content":"<strong>8. &#x63a8;&#x8350;&#x9605;&#x8bfb;</strong>","children":[{"content":"<strong>&#x300a;&#x8bbe;&#x8ba1;&#x6a21;&#x5f0f;&#xff1a;&#x53ef;&#x590d;&#x7528;&#x9762;&#x5411;&#x5bf9;&#x8c61;&#x8f6f;&#x4ef6;&#x7684;&#x57fa;&#x7840;&#x300b;</strong>&#xff08;GoF&#xff0c;&#x56db;&#x4eba;&#x5e2e;&#xff09;","children":[],"payload":{"tag":"li","lines":"1253,1254"}},{"content":"<strong>&#x300a;Head First &#x8bbe;&#x8ba1;&#x6a21;&#x5f0f;&#x300b;</strong>&#xff08;&#x56fe;&#x89e3;&#x7248;&#xff0c;&#x6613;&#x61c2;&#xff09;","children":[],"payload":{"tag":"li","lines":"1254,1255"}},{"content":"<strong>Python &#x5b98;&#x65b9;&#x6587;&#x6863;</strong>&#xff1a;typing &#x6a21;&#x5757;&#x3001;collections.abc &#x6a21;&#x5757;","children":[],"payload":{"tag":"li","lines":"1255,1256"}},{"content":"<strong>pydantic &#x6e90;&#x7801;</strong>&#xff1a;&#x5927;&#x91cf;&#x4f7f;&#x7528;&#x4e86;&#x5de5;&#x5382;&#x3001;&#x534f;&#x8bae;&#x3001;Mixin &#x6a21;&#x5f0f;","children":[],"payload":{"tag":"li","lines":"1256,1258"}}],"payload":{"tag":"h2","lines":"1251,1252"}},{"content":"<strong>9. &#x5feb;&#x901f;&#x53c2;&#x8003;</strong>","children":[{"content":"<strong>&#x521b;&#x5efa;&#x5bf9;&#x8c61;&#x65f6;</strong>","children":[{"content":"&#x9700;&#x8981;&#x6839;&#x636e;&#x914d;&#x7f6e;&#x9009;&#x62e9;&#x5b9e;&#x73b0; &#x2192; <strong>&#x5de5;&#x5382;&#x6a21;&#x5f0f;</strong>","children":[],"payload":{"tag":"li","lines":"1263,1264"}},{"content":"&#x9700;&#x8981;&#x5168;&#x5c40;&#x552f;&#x4e00;&#x5b9e;&#x4f8b; &#x2192; <strong>&#x5355;&#x4f8b;&#x6a21;&#x5f0f;</strong>","children":[],"payload":{"tag":"li","lines":"1264,1265"}},{"content":"&#x53c2;&#x6570;&#x592a;&#x591a;&#x3001;&#x6784;&#x5efa;&#x590d;&#x6742; &#x2192; <strong>&#x5efa;&#x9020;&#x8005;&#x6a21;&#x5f0f;</strong>","children":[],"payload":{"tag":"li","lines":"1265,1267"}}],"payload":{"tag":"h3","lines":"1262,1263"}},{"content":"<strong>&#x7ec4;&#x5408;&#x7c7b;&#x4e0e;&#x4f9d;&#x8d56;&#x65f6;</strong>&#xff08;&#x7ed3;&#x6784;&#x578b;&#xff09;","children":[{"content":"&#x9700;&#x8981;&#x6df7;&#x5165;&#x8f85;&#x52a9;&#x529f;&#x80fd; &#x2192; <strong>Mixin</strong>","children":[],"payload":{"tag":"li","lines":"1268,1269"}},{"content":"&#x9700;&#x8981;&#x5b9a;&#x4e49;&#x63a5;&#x53e3;&#x89c4;&#x8303; &#x2192; <strong>&#x534f;&#x8bae;&#x6a21;&#x5f0f;</strong>","children":[],"payload":{"tag":"li","lines":"1269,1270"}},{"content":"&#x9700;&#x8981;&#x7edf;&#x4e00;&#x4e0d;&#x540c;&#x63a5;&#x53e3; &#x2192; <strong>&#x9002;&#x914d;&#x5668;&#x6a21;&#x5f0f;</strong>","children":[],"payload":{"tag":"li","lines":"1270,1271"}},{"content":"&#x9700;&#x8981;&#x7b80;&#x5316;&#x590d;&#x6742;&#x5b50;&#x7cfb;&#x7edf; &#x2192; <strong>&#x5916;&#x89c2;&#x6a21;&#x5f0f;</strong>","children":[],"payload":{"tag":"li","lines":"1271,1272"}},{"content":"<strong>&#x7c7b;&#x6709;&#x5916;&#x90e8;&#x4f9d;&#x8d56;</strong> &#x2192; <strong>&#x4f9d;&#x8d56;&#x6ce8;&#x5165;</strong> &#x2b50;&#xff08;&#x59cb;&#x7ec8;&#x4f7f;&#x7528;&#xff0c;&#x53ef;&#x6d4b;&#x8bd5;&#x6027;&#x5173;&#x952e;&#xff09;","children":[],"payload":{"tag":"li","lines":"1272,1273"}},{"content":"<strong>&#x9700;&#x8981;&#x6570;&#x636e;&#x8bbf;&#x95ee;&#x5c42;</strong> &#x2192; <strong>&#x4ed3;&#x50a8;&#x6a21;&#x5f0f;</strong> &#x2b50;&#xff08;&#x9694;&#x79bb;&#x5b58;&#x50a8;&#x7ec6;&#x8282;&#xff09;","children":[],"payload":{"tag":"li","lines":"1273,1275"}}],"payload":{"tag":"h3","lines":"1267,1268"}},{"content":"<strong>&#x5904;&#x7406;&#x884c;&#x4e3a;&#x65f6;</strong>","children":[{"content":"&#x9700;&#x8981;&#x5207;&#x6362;&#x7b97;&#x6cd5; &#x2192; <strong>&#x7b56;&#x7565;&#x6a21;&#x5f0f;</strong>","children":[],"payload":{"tag":"li","lines":"1276,1277"}},{"content":"&#x9700;&#x8981;&#x72b6;&#x6001;&#x901a;&#x77e5; &#x2192; <strong>&#x89c2;&#x5bdf;&#x8005;&#x6a21;&#x5f0f;</strong>","children":[],"payload":{"tag":"li","lines":"1277,1278"}},{"content":"&#x9700;&#x8981;&#x52a8;&#x6001;&#x6dfb;&#x52a0;&#x529f;&#x80fd; &#x2192; <strong>&#x88c5;&#x9970;&#x5668;&#x6a21;&#x5f0f;</strong>","children":[],"payload":{"tag":"li","lines":"1278,1280"}}],"payload":{"tag":"h3","lines":"1275,1276"}}],"payload":{"tag":"h2","lines":"1260,1261"}},{"content":"<strong>&#x9644;&#x5f55;&#xff1a;12 &#x4e2a;&#x6a21;&#x5f0f;&#x7684;&#x672c;&#x8d28;&#x603b;&#x7ed3;</strong>","children":[{"content":"<strong>&#x6838;&#x5fc3;&#x4ef7;&#x503c;</strong>","children":[{"content":"1. <strong>&#x5982;&#x4f55;&#x521b;&#x5efa;&#x5bf9;&#x8c61;&#xff1f;</strong>&#xff08;&#x521b;&#x5efa;&#x578b; 3 &#x4e2a;&#xff09; &#x2192; &#x5de5;&#x5382;&#x3001;&#x5355;&#x4f8b;&#x3001;&#x5efa;&#x9020;&#x8005;","children":[],"payload":{"tag":"li","lines":"1288,1289","listIndex":1}},{"content":"2. <strong>&#x5982;&#x4f55;&#x7ec4;&#x5408;&#x529f;&#x80fd;&#xff1f;</strong>&#xff08;&#x7ed3;&#x6784;&#x578b; 6 &#x4e2a;&#xff09; &#x2192; Mixin&#x3001;&#x534f;&#x8bae;&#x3001;&#x9002;&#x914d;&#x5668;&#x3001;&#x5916;&#x89c2;&#x3001;<strong>&#x4f9d;&#x8d56;&#x6ce8;&#x5165;</strong>&#x3001;<strong>&#x4ed3;&#x50a8;</strong>","children":[],"payload":{"tag":"li","lines":"1289,1290","listIndex":2}},{"content":"3. <strong>&#x5982;&#x4f55;&#x5904;&#x7406;&#x53d8;&#x5316;&#xff1f;</strong>&#xff08;&#x884c;&#x4e3a;&#x578b; 3 &#x4e2a;&#xff09; &#x2192; &#x7b56;&#x7565;&#x3001;&#x89c2;&#x5bdf;&#x8005;&#x3001;&#x88c5;&#x9970;&#x5668;","children":[],"payload":{"tag":"li","lines":"1290,1292","listIndex":3}}],"payload":{"tag":"h3","lines":"1284,1285"}},{"content":"<strong>&#x6700;&#x91cd;&#x8981;&#x7684;&#x4e09;&#x4e2a;&#x6a21;&#x5f0f;</strong> &#x2b50;&#x2b50;&#x2b50;","children":[{"content":"1. <strong>&#x4f9d;&#x8d56;&#x6ce8;&#x5165;</strong>&#xff1a;&#x53ef;&#x6d4b;&#x8bd5;&#x6027;&#x7684;&#x57fa;&#x7840;&#xff0c;&#x73b0;&#x4ee3;&#x5f00;&#x53d1;&#x5fc5;&#x5907;","children":[],"payload":{"tag":"li","lines":"1296,1297","listIndex":1}},{"content":"2. <strong>&#x534f;&#x8bae;&#x6a21;&#x5f0f;</strong>&#xff1a;Python &#x7684;&#x63a5;&#x53e3;&#x5b9a;&#x4e49;&#xff0c;&#x4f18;&#x4e8e;&#x62bd;&#x8c61;&#x57fa;&#x7c7b;","children":[],"payload":{"tag":"li","lines":"1297,1298","listIndex":2}},{"content":"3. <strong>&#x5de5;&#x5382;&#x6a21;&#x5f0f;</strong>&#xff1a;&#x914d;&#x7f6e;&#x9a71;&#x52a8;&#xff0c;&#x89e3;&#x8026;&#x521b;&#x5efa;&#x903b;&#x8f91;","children":[],"payload":{"tag":"li","lines":"1298,1300","listIndex":3}}],"payload":{"tag":"h3","lines":"1292,1293"}},{"content":"<strong>&#x5176;&#x4f59; 23 &#x79cd; GoF &#x6a21;&#x5f0f;&#x4e3a;&#x4ec0;&#x4e48;&#x4e0d;&#x63a8;&#x8350;&#xff1f;</strong>","children":[{"content":"<table data-lines=\"1302,1319\">\n<thead data-lines=\"1302,1303\">\n<tr data-lines=\"1302,1303\">\n<th>&#x6a21;&#x5f0f;</th>\n<th>&#x4e0d;&#x63a8;&#x8350;&#x539f;&#x56e0;</th>\n</tr>\n</thead>\n<tbody data-lines=\"1304,1319\">\n<tr data-lines=\"1304,1305\">\n<td><strong>&#x8fed;&#x4ee3;&#x5668;</strong></td>\n<td>Python &#x539f;&#x751f;&#x652f;&#x6301;&#xff08;<code>__iter__</code>&#x3001;<code>__next__</code>&#xff09;</td>\n</tr>\n<tr data-lines=\"1305,1306\">\n<td><strong>&#x547d;&#x4ee4;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x4e00;&#x7b49;&#x51fd;&#x6570;&#x76f4;&#x63a5;&#x4f20;&#x9012;&#x5373;&#x53ef;</td>\n</tr>\n<tr data-lines=\"1306,1307\">\n<td><strong>&#x6a21;&#x677f;&#x65b9;&#x6cd5;</strong></td>\n<td>&#x7ee7;&#x627f;&#x5c31;&#x80fd;&#x5b9e;&#x73b0;&#xff0c;&#x592a;&#x7b80;&#x5355;</td>\n</tr>\n<tr data-lines=\"1307,1308\">\n<td><strong>&#x4eab;&#x5143;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x73b0;&#x4ee3;&#x786c;&#x4ef6;&#x5f88;&#x5c11;&#x9700;&#x8981;&#x5171;&#x4eab;&#x5bf9;&#x8c61;&#x8282;&#x7701;&#x5185;&#x5b58;</td>\n</tr>\n<tr data-lines=\"1308,1309\">\n<td><strong>&#x6865;&#x63a5;&#x6a21;&#x5f0f;</strong></td>\n<td>Python &#x7ec4;&#x5408;&#x8db3;&#x591f;&#x7075;&#x6d3b;</td>\n</tr>\n<tr data-lines=\"1309,1310\">\n<td><strong>&#x7ec4;&#x5408;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x7528;&#x5f97;&#x5c11;&#xff0c;&#x573a;&#x666f;&#x7279;&#x6b8a;&#xff08;&#x6811;&#x5f62;&#x7ed3;&#x6784;&#xff09;</td>\n</tr>\n<tr data-lines=\"1310,1311\">\n<td><strong>&#x4ee3;&#x7406;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x4e0e;&#x88c5;&#x9970;&#x5668;&#x3001;&#x5916;&#x89c2;&#x91cd;&#x53e0;</td>\n</tr>\n<tr data-lines=\"1311,1312\">\n<td><strong>&#x8d23;&#x4efb;&#x94fe;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x7528;&#x5f97;&#x5c11;&#xff0c;&#x4e2d;&#x95f4;&#x4ef6;&#x6a21;&#x5f0f;&#x66f4;&#x5e38;&#x89c1;</td>\n</tr>\n<tr data-lines=\"1312,1313\">\n<td><strong>&#x5907;&#x5fd8;&#x5f55;&#x6a21;&#x5f0f;</strong></td>\n<td>99% &#x9879;&#x76ee;&#x7528;&#x4e0d;&#x5230;</td>\n</tr>\n<tr data-lines=\"1313,1314\">\n<td><strong>&#x8bbf;&#x95ee;&#x8005;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x5728; Python &#x9e2d;&#x5b50;&#x7c7b;&#x578b;&#x4e0b;&#x5f88;&#x522b;&#x626d;</td>\n</tr>\n<tr data-lines=\"1314,1315\">\n<td><strong>&#x4e2d;&#x4ecb;&#x8005;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x6d88;&#x606f;&#x961f;&#x5217;/&#x4e8b;&#x4ef6;&#x603b;&#x7ebf;&#x66f4;&#x5e38;&#x89c1;</td>\n</tr>\n<tr data-lines=\"1315,1316\">\n<td><strong>&#x72b6;&#x6001;&#x6a21;&#x5f0f;</strong></td>\n<td>&#x7b56;&#x7565;&#x6a21;&#x5f0f;&#x7684;&#x7279;&#x4f8b;</td>\n</tr>\n<tr data-lines=\"1316,1317\">\n<td><strong>&#x539f;&#x578b;&#x6a21;&#x5f0f;</strong></td>\n<td><code>copy.deepcopy()</code> &#x89e3;&#x51b3;</td>\n</tr>\n<tr data-lines=\"1317,1318\">\n<td><strong>&#x62bd;&#x8c61;&#x5de5;&#x5382;</strong></td>\n<td>&#x5de5;&#x5382;&#x6a21;&#x5f0f;&#x7684;&#x53d8;&#x79cd;&#xff0c;&#x8fc7;&#x5ea6;&#x8bbe;&#x8ba1;</td>\n</tr>\n<tr data-lines=\"1318,1319\">\n<td><strong>&#x89e3;&#x91ca;&#x5668;&#x6a21;&#x5f0f;</strong></td>\n<td>99.9% &#x7684;&#x4eba;&#x4e00;&#x8f88;&#x5b50;&#x7528;&#x4e0d;&#x5230;</td>\n</tr>\n</tbody>\n</table>","children":[],"payload":{"tag":"table","lines":"1302,1319"}}],"payload":{"tag":"h3","lines":"1300,1301"}}],"payload":{"tag":"h2","lines":"1282,1283"}}],"payload":{"tag":"h1","lines":"0,1"}},null)</script>
</body>
</html>
